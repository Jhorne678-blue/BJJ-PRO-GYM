<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BJJProGym - Professional Brazilian Jiu-Jitsu Management System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #1e3a8a 0%, #312e81 50%, #1e1b4b 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .glass-button {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.8), rgba(147, 51, 234, 0.8));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .glass-button:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(147, 51, 234, 0.9));
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* UNIVERSAL INPUT STYLING */
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"], 
        input[type="time"], input[type="date"], input[type="number"], textarea, select {
            background-color: white !important;
            color: #1f2937 !important;
            border: 2px solid #e5e7eb !important;
            border-radius: 8px !important;
            padding: 12px 16px !important;
            font-size: 16px !important;
            min-height: 50px !important;
            width: 100% !important;
            box-sizing: border-box !important;
            -webkit-appearance: none !important;
            font-family: 'Inter', sans-serif !important;
        }

        input:focus, textarea:focus, select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }

        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e") !important;
            background-position: right 12px center !important;
            background-repeat: no-repeat !important;
            background-size: 16px 16px !important;
            padding-right: 40px !important;
        }

        button {
            min-height: 50px !important;
            padding: 12px 24px !important;
            font-size: 16px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            border: none !important;
            cursor: pointer !important;
            font-family: 'Inter', sans-serif !important;
            display: inline-flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.3s ease !important;
        }

        .pro-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1f2937;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .member-id-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: 'Courier New', monospace;
        }

        .card-number-badge {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: 'Courier New', monospace;
        }

        .belt-white { background: linear-gradient(135deg, #ffffff, #f3f4f6); color: #1f2937; }
        .belt-blue { background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; }
        .belt-purple { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
        .belt-brown { background: linear-gradient(135deg, #92400e, #78350f); color: white; }
        .belt-black { background: linear-gradient(135deg, #1f2937, #111827); color: white; }

        .success-pulse {
            animation: successPulse 0.6s ease-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        #root {
            width: 100%;
            min-height: 100vh;
        }

        .plan-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .plan-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .plan-card.selected {
            border: 2px solid #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // API Configuration - PRODUCTION READY
        const API_BASE = 'https://api.bjjprogym.com'; // UPDATE THIS TO YOUR PRODUCTION API URL
        const STRIPE_PUBLISHABLE_KEY = 'pk_live_...'; // UPDATE THIS TO YOUR REAL STRIPE KEY

        // Authentication & API Service
        class APIService {
            constructor() {
                this.baseURL = API_BASE;
                this.token = localStorage.getItem('auth_token');
            }

            async request(endpoint, options = {}) {
                const url = `${this.baseURL}${endpoint}`;
                const config = {
                    headers: {
                        'Content-Type': 'application/json',
                        ...(this.token && { 'Authorization': `Bearer ${this.token}` }),
                        ...options.headers,
                    },
                    ...options,
                };

                if (config.body && typeof config.body === 'object') {
                    config.body = JSON.stringify(config.body);
                }

                try {
                    const response = await fetch(url, config);
                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(data.message || 'API request failed');
                    }
                    
                    return data;
                } catch (error) {
                    console.error('API Request failed:', error);
                    throw error;
                }
            }

            // Authentication endpoints
            async register(userData) {
                return this.request('/auth/register', {
                    method: 'POST',
                    body: userData
                });
            }

            async verifyEmail(token) {
                return this.request('/auth/verify-email', {
                    method: 'POST',
                    body: { token }
                });
            }

            async login(credentials) {
                const response = await this.request('/auth/login', {
                    method: 'POST',
                    body: credentials
                });
                if (response.access_token) {
                    this.token = response.access_token;
                    localStorage.setItem('auth_token', this.token);
                }
                return response;
            }

            async validateAccessCode(code) {
                return this.request('/auth/validate-access-code', {
                    method: 'POST',
                    body: { code }
                });
            }

            // Gym management endpoints
            async createGym(gymData) {
                return this.request('/gyms', {
                    method: 'POST',
                    body: gymData
                });
            }

            async getStudents() {
                return this.request('/students');
            }

            async createStudent(studentData) {
                return this.request('/students', {
                    method: 'POST',
                    body: studentData
                });
            }

            async updateStudent(id, studentData) {
                return this.request(`/students/${id}`, {
                    method: 'PUT',
                    body: studentData
                });
            }

            async deleteStudent(id) {
                return this.request(`/students/${id}`, {
                    method: 'DELETE'
                });
            }

            async getClasses() {
                return this.request('/classes');
            }

            async createClass(classData) {
                return this.request('/classes', {
                    method: 'POST',
                    body: classData
                });
            }

            async updateClass(id, classData) {
                return this.request(`/classes/${id}`, {
                    method: 'PUT',
                    body: classData
                });
            }

            async deleteClass(id) {
                return this.request(`/classes/${id}`, {
                    method: 'DELETE'
                });
            }

            async getSchedules() {
                return this.request('/schedules');
            }

            async createSchedule(scheduleData) {
                return this.request('/schedules', {
                    method: 'POST',
                    body: scheduleData
                });
            }

            async updateSchedule(id, scheduleData) {
                return this.request(`/schedules/${id}`, {
                    method: 'PUT',
                    body: scheduleData
                });
            }

            async deleteSchedule(id) {
                return this.request(`/schedules/${id}`, {
                    method: 'DELETE'
                });
            }

            async getAttendance(filters = {}) {
                const params = new URLSearchParams(filters);
                return this.request(`/attendance?${params}`);
            }

            async recordCheckIn(checkInData) {
                return this.request('/attendance/checkin', {
                    method: 'POST',
                    body: checkInData
                });
            }

            async getAnalytics(period = 'month') {
                return this.request(`/analytics?period=${period}`);
            }

            async getRiskAnalysis() {
                return this.request('/risk-analysis');
            }

            async sendEmail(emailData) {
                return this.request('/communications/send-email', {
                    method: 'POST',
                    body: emailData
                });
            }

            async getEmailHistory() {
                return this.request('/communications/history');
            }

            async getSystemStatus() {
                return this.request('/system/status');
            }

            async initiateBackup() {
                return this.request('/system/backup', {
                    method: 'POST'
                });
            }
        }

        const api = new APIService();

        // Landing Page - Access Code Entry & Plan Selection
        const LandingPage = ({ onAccessValidated }) => {
            const [step, setStep] = useState('access-code'); // access-code, plan-selection, registration
            const [accessCode, setAccessCode] = useState('');
            const [selectedPlan, setSelectedPlan] = useState('professional');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            const plans = [
                {
                    id: 'basic',
                    name: 'Basic',
                    price: 97,
                    features: [
                        'Up to 100 students',
                        'Basic student management',
                        'Class scheduling',
                        'Email support'
                    ]
                },
                {
                    id: 'professional',
                    name: 'Professional',
                    price: 197,
                    features: [
                        'Up to 500 students',
                        'Advanced analytics',
                        'RFID card integration',
                        'Risk analysis',
                        'Email campaigns',
                        'Priority support'
                    ],
                    recommended: true
                },
                {
                    id: 'enterprise',
                    name: 'Enterprise',
                    price: 397,
                    features: [
                        'Unlimited students',
                        'Multi-location management',
                        'White-label branding',
                        'Custom integrations',
                        'Dedicated support'
                    ]
                }
            ];

            const handleAccessCodeSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    const result = await api.validateAccessCode(accessCode);
                    if (result.valid) {
                        if (accessCode.toUpperCase() === 'ADELYNN14') {
                            setSelectedPlan('professional');
                        }
                        setStep('plan-selection');
                    } else {
                        setError('Invalid access code. Please contact support.');
                    }
                } catch (err) {
                    setError('Unable to validate access code. Please try again.');
                }
                setIsLoading(false);
            };

            const handlePlanSelection = () => {
                setStep('registration');
            };

            const handleRegistration = () => {
                onAccessValidated({
                    accessCode,
                    selectedPlan,
                    planDetails: plans.find(p => p.id === selectedPlan)
                });
            };

            if (step === 'access-code') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="glass-effect rounded-3xl p-8 w-full max-w-md">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-white mb-4">🥋 BJJProGym</h1>
                                <div className="pro-badge mx-auto mb-4">Professional Platform</div>
                                <p className="text-blue-100 mb-6">The #1 Brazilian Jiu-Jitsu Academy Management System</p>
                            </div>

                            <form onSubmit={handleAccessCodeSubmit} className="space-y-6">
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Professional Access Code
                                    </label>
                                    <input
                                        type="text"
                                        value={accessCode}
                                        onChange={(e) => setAccessCode(e.target.value.toUpperCase())}
                                        placeholder="Enter your access code"
                                        required
                                        autoFocus
                                        style={{ textTransform: 'uppercase', letterSpacing: '2px', textAlign: 'center' }}
                                    />
                                </div>

                                {error && (
                                    <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg text-center">
                                        {error}
                                    </div>
                                )}

                                <button
                                    type="submit"
                                    disabled={isLoading || !accessCode}
                                    className="glass-button w-full text-white font-semibold"
                                >
                                    {isLoading ? 'Validating...' : '🔓 Validate Access Code'}
                                </button>
                            </form>

                            <div className="mt-6 text-center text-blue-300 text-sm">
                                <p>Need an access code?</p>
                                <button className="text-blue-200 hover:text-white underline mt-2">
                                    Contact Sales
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (step === 'plan-selection') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="glass-effect rounded-3xl p-8 w-full max-w-6xl">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-white mb-4">Choose Your Plan</h1>
                                <p className="text-blue-100">Access code validated ✅ Now select your plan</p>
                                {accessCode.toUpperCase() === 'ADELYNN14' && (
                                    <div className="mt-4 bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-2 rounded-lg">
                                        🎉 Special offer: Professional Plan unlocked with your access code!
                                    </div>
                                )}
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                {plans.map((plan) => (
                                    <div
                                        key={plan.id}
                                        className={`plan-card glass-effect rounded-xl p-6 relative ${
                                            selectedPlan === plan.id ? 'selected' : ''
                                        }`}
                                        onClick={() => setSelectedPlan(plan.id)}
                                    >
                                        {plan.recommended && (
                                            <div className="absolute -top-3 left-1/2 transform -translate-x-1/2">
                                                <span className="bg-gradient-to-r from-yellow-400 to-orange-500 text-black px-4 py-1 rounded-full text-sm font-bold">
                                                    RECOMMENDED
                                                </span>
                                            </div>
                                        )}
                                        
                                        <div className="text-center mb-6">
                                            <h3 className="text-2xl font-bold text-white mb-2">{plan.name}</h3>
                                            <div className="text-4xl font-bold text-white mb-1">${plan.price}</div>
                                            <div className="text-blue-200 text-sm">per month</div>
                                        </div>

                                        <ul className="space-y-3 mb-6">
                                            {plan.features.map((feature, index) => (
                                                <li key={index} className="flex items-center text-blue-100">
                                                    <span className="text-green-400 mr-2">✓</span>
                                                    {feature}
                                                </li>
                                            ))}
                                        </ul>

                                        <div className="text-center">
                                            <div className={`w-4 h-4 rounded-full mx-auto ${
                                                selectedPlan === plan.id ? 'bg-blue-500' : 'bg-gray-400'
                                            }`}></div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <div className="text-center">
                                <button
                                    onClick={handlePlanSelection}
                                    className="glass-button px-8 py-3 text-white font-semibold text-lg"
                                >
                                    Continue with {plans.find(p => p.id === selectedPlan)?.name} Plan
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (step === 'registration') {
                return <GymRegistration onRegistered={handleRegistration} planDetails={plans.find(p => p.id === selectedPlan)} />;
            }
        };

        // Gym Registration Component
        const GymRegistration = ({ onRegistered, planDetails }) => {
            const [formData, setFormData] = useState({
                gymName: '',
                ownerName: '',
                ownerEmail: '',
                password: '',
                confirmPassword: '',
                address: '',
                phone: '',
                website: ''
            });
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                if (formData.password !== formData.confirmPassword) {
                    setError('Passwords do not match');
                    setIsLoading(false);
                    return;
                }

                try {
                    const registrationData = {
                        ...formData,
                        planId: planDetails.id,
                        planPrice: planDetails.price
                    };

                    const result = await api.register(registrationData);
                    
                    if (result.success) {
                        onRegistered(result);
                    } else {
                        setError(result.message || 'Registration failed');
                    }
                } catch (err) {
                    setError('Registration failed. Please try again.');
                }
                setIsLoading(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="glass-effect rounded-3xl p-8 w-full max-w-2xl">
                        <div className="text-center mb-8">
                            <h1 className="text-3xl font-bold text-white mb-2">Create Your Gym Account</h1>
                            <div className="flex items-center justify-center gap-2 mb-4">
                                <span className="text-blue-100">Plan:</span>
                                <span className="pro-badge">{planDetails.name} - ${planDetails.price}/month</span>
                            </div>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Gym Name *
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.gymName}
                                        onChange={(e) => setFormData({...formData, gymName: e.target.value})}
                                        required
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Owner Name *
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.ownerName}
                                        onChange={(e) => setFormData({...formData, ownerName: e.target.value})}
                                        required
                                    />
                                </div>
                            </div>

                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                    Email Address *
                                </label>
                                <input
                                    type="email"
                                    value={formData.ownerEmail}
                                    onChange={(e) => setFormData({...formData, ownerEmail: e.target.value})}
                                    required
                                />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Password *
                                    </label>
                                    <input
                                        type="password"
                                        value={formData.password}
                                        onChange={(e) => setFormData({...formData, password: e.target.value})}
                                        required
                                        minLength="8"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Confirm Password *
                                    </label>
                                    <input
                                        type="password"
                                        value={formData.confirmPassword}
                                        onChange={(e) => setFormData({...formData, confirmPassword: e.target.value})}
                                        required
                                        minLength="8"
                                    />
                                </div>
                            </div>

                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                    Gym Address
                                </label>
                                <input
                                    type="text"
                                    value={formData.address}
                                    onChange={(e) => setFormData({...formData, address: e.target.value})}
                                />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Phone Number
                                    </label>
                                    <input
                                        type="tel"
                                        value={formData.phone}
                                        onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-blue-100 text-sm font-medium mb-2">
                                        Website
                                    </label>
                                    <input
                                        type="text"
                                        value={formData.website}
                                        onChange={(e) => setFormData({...formData, website: e.target.value})}
                                        placeholder="https://yourgym.com"
                                    />
                                </div>
                            </div>

                            {error && (
                                <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                                    {error}
                                </div>
                            )}

                            <button
                                type="submit"
                                disabled={isLoading}
                                className="glass-button w-full text-white font-semibold text-lg"
                            >
                                {isLoading ? 'Creating Account...' : '🚀 Create Gym Account'}
                            </button>
                        </form>

                        <div className="mt-6 text-center text-blue-300 text-sm">
                            <p>By creating an account, you agree to our Terms of Service and Privacy Policy</p>
                        </div>
                    </div>
                </div>
            );
        };

        // Email Verification Component
        const EmailVerification = ({ email, onVerified }) => {
            const [verificationCode, setVerificationCode] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            const handleVerify = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    const result = await api.verifyEmail(verificationCode);
                    if (result.success) {
                        onVerified(result);
                    } else {
                        setError('Invalid verification code');
                    }
                } catch (err) {
                    setError('Verification failed. Please try again.');
                }
                setIsLoading(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="glass-effect rounded-3xl p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <div className="text-6xl mb-4">📧</div>
                            <h1 className="text-3xl font-bold text-white mb-4">Verify Your Email</h1>
                            <p className="text-blue-100 mb-4">
                                We've sent a verification code to:
                            </p>
                            <p className="text-white font-semibold">{email}</p>
                        </div>

                        <form onSubmit={handleVerify} className="space-y-6">
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                    Verification Code
                                </label>
                                <input
                                    type="text"
                                    value={verificationCode}
                                    onChange={(e) => setVerificationCode(e.target.value)}
                                    placeholder="Enter 6-digit code"
                                    required
                                    autoFocus
                                    style={{ textAlign: 'center', letterSpacing: '4px' }}
                                />
                            </div>

                            {error && (
                                <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                                    {error}
                                </div>
                            )}

                            <button
                                type="submit"
                                disabled={isLoading || !verificationCode}
                                className="glass-button w-full text-white font-semibold"
                            >
                                {isLoading ? 'Verifying...' : '✅ Verify Email'}
                            </button>
                        </form>

                        <div className="mt-6 text-center">
                            <button className="text-blue-200 hover:text-white underline text-sm">
                                Resend verification code
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Login Component for returning users
        const Login = ({ onLogin }) => {
            const [formData, setFormData] = useState({
                email: '',
                password: ''
            });
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    const result = await api.login(formData);
                    if (result.access_token) {
                        onLogin(result.user);
                    } else {
                        setError('Invalid credentials');
                    }
                } catch (err) {
                    setError('Login failed. Please check your credentials.');
                }
                setIsLoading(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="glass-effect rounded-3xl p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-white mb-4">🥋 BJJProGym</h1>
                            <p className="text-blue-100">Welcome back! Sign in to your gym dashboard</p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                    Email Address
                                </label>
                                <input
                                    type="email"
                                    value={formData.email}
                                    onChange={(e) => setFormData({...formData, email: e.target.value})}
                                    required
                                    autoFocus
                                />
                            </div>

                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                    Password
                                </label>
                                <input
                                    type="password"
                                    value={formData.password}
                                    onChange={(e) => setFormData({...formData, password: e.target.value})}
                                    required
                                />
                            </div>

                            {error && (
                                <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                                    {error}
                                </div>
                            )}

                            <button
                                type="submit"
                                disabled={isLoading}
                                className="glass-button w-full text-white font-semibold"
                            >
                                {isLoading ? 'Signing in...' : '🚀 Sign In'}
                            </button>
                        </form>

                        <div className="mt-6 text-center">
                            <button className="text-blue-200 hover:text-white underline text-sm">
                                Forgot password?
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Student Management Component - PRODUCTION READY
        const StudentManagement = () => {
            const [students, setStudents] = useState([]);
            const [filteredStudents, setFilteredStudents] = useState([]);
            const [showAddForm, setShowAddForm] = useState(false);
            const [editingStudent, setEditingStudent] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [success, setSuccess] = useState('');
            const [error, setError] = useState('');
            
            // Filter states
            const [filters, setFilters] = useState({
                name: '',
                email: '',
                phone: '',
                belt: '',
                memberId: '',
                cardNumber: ''
            });

            // Form state
            const [studentForm, setStudentForm] = useState({
                name: '',
                email: '',
                phone: '',
                belt_level: 'White',
                emergency_contact: '',
                emergency_phone: '',
                medical_notes: '',
                membership_type: 'monthly'
            });

            useEffect(() => {
                loadStudents();
            }, []);

            useEffect(() => {
                applyFilters();
            }, [students, filters]);

            const loadStudents = async () => {
                setIsLoading(true);
                try {
                    const response = await api.getStudents();
                    setStudents(response.students || []);
                } catch (err) {
                    setError('Failed to load students');
                } finally {
                    setIsLoading(false);
                }
            };

            const applyFilters = () => {
                let filtered = students.filter(student => {
                    return Object.keys(filters).every(key => {
                        if (!filters[key]) return true;
                        const value = student[key === 'memberId' ? 'member_id' : key === 'cardNumber' ? 'card_number' : key];
                        return value && value.toLowerCase().includes(filters[key].toLowerCase());
                    });
                });
                setFilteredStudents(filtered);
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    if (editingStudent) {
                        await api.updateStudent(editingStudent.id, studentForm);
                        setSuccess('✅ Student updated successfully!');
                    } else {
                        await api.createStudent(studentForm);
                        setSuccess('✅ Student added successfully!');
                    }
                    
                    setStudentForm({
                        name: '',
                        email: '',
                        phone: '',
                        belt_level: 'White',
                        emergency_contact: '',
                        emergency_phone: '',
                        medical_notes: '',
                        membership_type: 'monthly'
                    });
                    setShowAddForm(false);
                    setEditingStudent(null);
                    loadStudents();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to save student');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleEdit = (student) => {
                setStudentForm({
                    name: student.name,
                    email: student.email || '',
                    phone: student.phone || '',
                    belt_level: student.belt_level,
                    emergency_contact: student.emergency_contact || '',
                    emergency_phone: student.emergency_phone || '',
                    medical_notes: student.medical_notes || '',
                    membership_type: student.membership_type || 'monthly'
                });
                setEditingStudent(student);
                setShowAddForm(true);
            };

            const handleDelete = async (student) => {
                if (!confirm(`Are you sure you want to delete ${student.name}? This action cannot be undone.`)) return;
                
                try {
                    await api.deleteStudent(student.id);
                    setSuccess(`✅ ${student.name} deleted successfully!`);
                    loadStudents();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to delete student');
                }
            };

            const belts = ['White', 'Blue', 'Purple', 'Brown', 'Black'];

            return (
                <div className="space-y-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <h2 className="text-2xl font-bold text-white">👥 Student Management</h2>
                        <button
                            onClick={() => {
                                setEditingStudent(null);
                                setStudentForm({
                                    name: '',
                                    email: '',
                                    phone: '',
                                    belt_level: 'White',
                                    emergency_contact: '',
                                    emergency_phone: '',
                                    medical_notes: '',
                                    membership_type: 'monthly'
                                });
                                setShowAddForm(true);
                            }}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ➕ Add Student
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    {error && (
                        <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                            {error}
                        </div>
                    )}

                    {/* Advanced Filtering */}
                    <div className="glass-effect rounded-xl p-6">
                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4">
                            <h3 className="text-lg font-semibold text-white">🔍 Advanced Filters</h3>
                            <button
                                onClick={() => setFilters({ name: '', email: '', phone: '', belt: '', memberId: '', cardNumber: '' })}
                                className="text-blue-300 hover:text-white text-sm underline"
                            >
                                Clear All Filters
                            </button>
                        </div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <input
                                type="text"
                                value={filters.name}
                                onChange={(e) => setFilters({...filters, name: e.target.value})}
                                placeholder="Filter by name..."
                            />
                            <input
                                type="text"
                                value={filters.email}
                                onChange={(e) => setFilters({...filters, email: e.target.value})}
                                placeholder="Filter by email..."
                            />
                            <input
                                type="text"
                                value={filters.phone}
                                onChange={(e) => setFilters({...filters, phone: e.target.value})}
                                placeholder="Filter by phone..."
                            />
                            <select
                                value={filters.belt}
                                onChange={(e) => setFilters({...filters, belt: e.target.value})}
                            >
                                <option value="">All Belts</option>
                                {belts.map(belt => (
                                    <option key={belt} value={belt}>{belt} Belt</option>
                                ))}
                            </select>
                            <input
                                type="text"
                                value={filters.memberId}
                                onChange={(e) => setFilters({...filters, memberId: e.target.value})}
                                placeholder="Filter by Member ID..."
                            />
                            <input
                                type="text"
                                value={filters.cardNumber}
                                onChange={(e) => setFilters({...filters, cardNumber: e.target.value})}
                                placeholder="Filter by Card Number..."
                            />
                        </div>

                        <div className="mt-4 text-blue-200 text-sm">
                            Showing {filteredStudents.length} of {students.length} students
                        </div>
                    </div>

                    {/* Students List */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">Students ({filteredStudents.length})</h3>
                        
                        {isLoading ? (
                            <div className="text-center py-8">
                                <div className="text-blue-200">Loading students...</div>
                            </div>
                        ) : filteredStudents.length === 0 ? (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">👥</div>
                                <div className="text-blue-200 text-lg mb-2">
                                    {students.length === 0 ? 'No students registered yet' : 'No students match your filters'}
                                </div>
                                <div className="text-blue-300 text-sm">
                                    {students.length === 0 ? 'Add your first student to get started!' : 'Try adjusting your filters'}
                                </div>
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {filteredStudents.map((student) => (
                                    <div key={student.id} className="bg-white bg-opacity-10 rounded-lg p-4 hover:bg-opacity-20 transition-colors">
                                        <div className="flex flex-col lg:flex-row justify-between items-start gap-4">
                                            <div className="flex-1">
                                                <div className="flex flex-col sm:flex-row items-start sm:items-center gap-3 mb-2">
                                                    <h4 className="font-semibold text-white text-lg">{student.name}</h4>
                                                    <span className={`belt-${student.belt_level.toLowerCase()} px-3 py-1 rounded-full text-sm font-medium`}>
                                                        {student.belt_level} Belt
                                                    </span>
                                                </div>
                                                
                                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 text-blue-100 text-sm mb-2">
                                                    {student.email && <div>📧 {student.email}</div>}
                                                    {student.phone && <div>📱 {student.phone}</div>}
                                                </div>
                                                
                                                <div className="flex flex-wrap gap-2">
                                                    <span className="member-id-badge">{student.member_id}</span>
                                                    <span className="card-number-badge">{student.card_number}</span>
                                                </div>
                                            </div>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => handleEdit(student)}
                                                    className="bg-blue-600 hover:bg-blue-700 px-3 py-2 text-white text-sm rounded-lg"
                                                >
                                                    ✏️ Edit
                                                </button>
                                                <button
                                                    onClick={() => handleDelete(student)}
                                                    className="bg-red-600 hover:bg-red-700 px-3 py-2 text-white text-sm rounded-lg"
                                                >
                                                    🗑️ Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Add/Edit Student Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-bold text-white mb-4">
                                    {editingStudent ? 'Edit Student' : 'Add New Student'}
                                </h3>
                                
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Name *</label>
                                            <input
                                                type="text"
                                                value={studentForm.name}
                                                onChange={(e) => setStudentForm({...studentForm, name: e.target.value})}
                                                required
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Belt Level</label>
                                            <select
                                                value={studentForm.belt_level}
                                                onChange={(e) => setStudentForm({...studentForm, belt_level: e.target.value})}
                                            >
                                                {belts.map(belt => (
                                                    <option key={belt} value={belt}>{belt} Belt</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Email</label>
                                            <input
                                                type="email"
                                                value={studentForm.email}
                                                onChange={(e) => setStudentForm({...studentForm, email: e.target.value})}
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Phone</label>
                                            <input
                                                type="tel"
                                                value={studentForm.phone}
                                                onChange={(e) => setStudentForm({...studentForm, phone: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Emergency Contact</label>
                                            <input
                                                type="text"
                                                value={studentForm.emergency_contact}
                                                onChange={(e) => setStudentForm({...studentForm, emergency_contact: e.target.value})}
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Emergency Phone</label>
                                            <input
                                                type="tel"
                                                value={studentForm.emergency_phone}
                                                onChange={(e) => setStudentForm({...studentForm, emergency_phone: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Membership Type</label>
                                        <select
                                            value={studentForm.membership_type}
                                            onChange={(e) => setStudentForm({...studentForm, membership_type: e.target.value})}
                                        >
                                            <option value="monthly">Monthly</option>
                                            <option value="quarterly">Quarterly</option>
                                            <option value="yearly">Yearly</option>
                                            <option value="drop-in">Drop-in</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Medical Notes</label>
                                        <textarea
                                            value={studentForm.medical_notes}
                                            onChange={(e) => setStudentForm({...studentForm, medical_notes: e.target.value})}
                                            rows="3"
                                            placeholder="Any medical conditions or notes..."
                                        />
                                    </div>
                                    
                                    <div className="flex gap-3">
                                        <button
                                            type="submit"
                                            disabled={isLoading}
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            {isLoading ? 'Saving...' : editingStudent ? 'Update Student' : 'Add Student'}
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => {
                                                setShowAddForm(false);
                                                setEditingStudent(null);
                                            }}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Classes Management Component - PRODUCTION READY
        const ClassesManagement = () => {
            const [classes, setClasses] = useState([]);
            const [showAddForm, setShowAddForm] = useState(false);
            const [editingClass, setEditingClass] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [success, setSuccess] = useState('');
            const [error, setError] = useState('');
            
            const [classForm, setClassForm] = useState({
                name: '',
                description: '',
                capacity: '',
                duration: ''
            });

            useEffect(() => {
                loadClasses();
            }, []);

            const loadClasses = async () => {
                setIsLoading(true);
                try {
                    const response = await api.getClasses();
                    setClasses(response.classes || []);
                } catch (err) {
                    setError('Failed to load classes');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    if (editingClass) {
                        await api.updateClass(editingClass.id, classForm);
                        setSuccess('✅ Class updated successfully!');
                    } else {
                        await api.createClass(classForm);
                        setSuccess('✅ Class added successfully!');
                    }
                    
                    setClassForm({ name: '', description: '', capacity: '', duration: '' });
                    setShowAddForm(false);
                    setEditingClass(null);
                    loadClasses();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to save class');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleDelete = async (classItem) => {
                if (!confirm(`Are you sure you want to delete "${classItem.name}"? This action cannot be undone.`)) return;
                
                try {
                    await api.deleteClass(classItem.id);
                    setSuccess(`✅ ${classItem.name} deleted successfully!`);
                    loadClasses();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to delete class');
                }
            };

            return (
                <div className="space-y-6">
                    <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                        <div>
                            <h2 className="text-3xl font-bold text-white mb-2">📚 Classes Management</h2>
                            <p className="text-blue-100">Manage your BJJ classes and training programs</p>
                        </div>
                        <button
                            onClick={() => {
                                setEditingClass(null);
                                setClassForm({ name: '', description: '', capacity: '', duration: '' });
                                setShowAddForm(true);
                            }}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ➕ Add New Class
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    {error && (
                        <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                            {error}
                        </div>
                    )}

                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-xl font-semibold text-white mb-6">Classes ({classes.length})</h3>
                        
                        {isLoading ? (
                            <div className="text-center py-8">
                                <div className="text-blue-200">Loading classes...</div>
                            </div>
                        ) : classes.length === 0 ? (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">📚</div>
                                <div className="text-blue-200 text-lg mb-2">No classes created yet</div>
                                <div className="text-blue-300 text-sm">Create your first class to start organizing training programs!</div>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {classes.map((classItem) => (
                                    <div key={classItem.id} className="bg-white bg-opacity-10 rounded-lg p-6 hover:bg-opacity-20 transition-all duration-300 border border-white border-opacity-20">
                                        <div className="flex justify-between items-start mb-4">
                                            <div className="flex-1">
                                                <h4 className="font-bold text-white text-xl mb-2">{classItem.name}</h4>
                                                <div className="flex flex-wrap gap-2 mb-3">
                                                    <span className="bg-blue-500 bg-opacity-30 px-3 py-1 rounded-full text-blue-100 text-sm font-medium">
                                                        🥋 BJJ Class
                                                    </span>
                                                    {classItem.capacity && (
                                                        <span className="bg-green-500 bg-opacity-30 px-3 py-1 rounded-full text-green-100 text-sm font-medium">
                                                            👥 {classItem.capacity} max
                                                        </span>
                                                    )}
                                                    {classItem.duration && (
                                                        <span className="bg-purple-500 bg-opacity-30 px-3 py-1 rounded-full text-purple-100 text-sm font-medium">
                                                            ⏱️ {classItem.duration}min
                                                        </span>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {classItem.description && (
                                            <div className="text-blue-100 text-sm mb-4">
                                                📝 {classItem.description}
                                            </div>
                                        )}
                                        
                                        <div className="flex justify-between items-center">
                                            <span className="bg-green-500 bg-opacity-20 px-2 py-1 rounded text-green-100 text-xs">
                                                Active
                                            </span>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => {
                                                        setClassForm({
                                                            name: classItem.name,
                                                            description: classItem.description || '',
                                                            capacity: classItem.capacity || '',
                                                            duration: classItem.duration || ''
                                                        });
                                                        setEditingClass(classItem);
                                                        setShowAddForm(true);
                                                    }}
                                                    className="bg-blue-600 hover:bg-blue-700 px-3 py-2 text-white text-sm rounded-lg"
                                                >
                                                    ✏️
                                                </button>
                                                <button
                                                    onClick={() => handleDelete(classItem)}
                                                    className="bg-red-600 hover:bg-red-700 px-3 py-2 text-white text-sm rounded-lg"
                                                >
                                                    🗑️
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Add/Edit Class Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto">
                                <h3 className="text-2xl font-bold text-white mb-6">
                                    {editingClass ? 'Edit Class' : 'Add New Class'}
                                </h3>
                                
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-semibold mb-3">
                                            Class Name *
                                        </label>
                                        <input
                                            type="text"
                                            value={classForm.name}
                                            onChange={(e) => setClassForm({...classForm, name: e.target.value})}
                                            placeholder="e.g., Fundamentals, Advanced, No-Gi, Kids Program"
                                            required
                                            autoFocus
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-blue-100 text-sm font-semibold mb-3">
                                            Description
                                        </label>
                                        <textarea
                                            value={classForm.description}
                                            onChange={(e) => setClassForm({...classForm, description: e.target.value})}
                                            placeholder="Describe what this class focuses on, skill level, techniques covered..."
                                            rows="4"
                                            className="w-full resize-none"
                                        />
                                    </div>

                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-semibold mb-3">
                                                Max Capacity
                                            </label>
                                            <input
                                                type="number"
                                                value={classForm.capacity}
                                                onChange={(e) => setClassForm({...classForm, capacity: e.target.value})}
                                                placeholder="20"
                                                min="1"
                                                max="100"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-blue-100 text-sm font-semibold mb-3">
                                                Duration (minutes)
                                            </label>
                                            <input
                                                type="number"
                                                value={classForm.duration}
                                                onChange={(e) => setClassForm({...classForm, duration: e.target.value})}
                                                placeholder="60"
                                                min="15"
                                                max="180"
                                            />
                                        </div>
                                    </div>
                                    
                                    <div className="flex gap-3 pt-4">
                                        <button
                                            type="submit"
                                            disabled={isLoading}
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            {isLoading ? 'Saving...' : editingClass ? 'Update Class' : 'Add Class'}
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => {
                                                setShowAddForm(false);
                                                setEditingClass(null);
                                            }}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Schedule Management Component - PRODUCTION READY
        const ScheduleManagement = () => {
            const [schedules, setSchedules] = useState([]);
            const [classes, setClasses] = useState([]);
            const [showAddForm, setShowAddForm] = useState(false);
            const [isLoading, setIsLoading] = useState(false);
            const [success, setSuccess] = useState('');
            const [error, setError] = useState('');
            
            const [scheduleForm, setScheduleForm] = useState({
                class_id: '',
                day_of_week: 0,
                start_time: '18:00',
                end_time: '19:00',
                instructor: ''
            });

            const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            useEffect(() => {
                loadSchedules();
                loadClasses();
            }, []);

            const loadSchedules = async () => {
                setIsLoading(true);
                try {
                    const response = await api.getSchedules();
                    setSchedules(response.schedules || []);
                } catch (err) {
                    setError('Failed to load schedules');
                } finally {
                    setIsLoading(false);
                }
            };

            const loadClasses = async () => {
                try {
                    const response = await api.getClasses();
                    setClasses(response.classes || []);
                } catch (err) {
                    console.error('Failed to load classes');
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    await api.createSchedule(scheduleForm);
                    setSuccess('✅ Schedule added successfully!');
                    setScheduleForm({
                        class_id: '',
                        day_of_week: 0,
                        start_time: '18:00',
                        end_time: '19:00',
                        instructor: ''
                    });
                    setShowAddForm(false);
                    loadSchedules();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to save schedule');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleDelete = async (schedule) => {
                if (!confirm('Are you sure you want to delete this schedule?')) return;
                
                try {
                    await api.deleteSchedule(schedule.id);
                    setSuccess('✅ Schedule deleted successfully!');
                    loadSchedules();
                    setTimeout(() => setSuccess(''), 3000);
                } catch (err) {
                    setError('Failed to delete schedule');
                }
            };

            const formatTime = (time) => {
                const [hours, minutes] = time.split(':');
                const hour = parseInt(hours);
                const ampm = hour >= 12 ? 'PM' : 'AM';
                const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
                return `${displayHour}:${minutes} ${ampm}`;
            };

            const getClassName = (classId) => {
                const classItem = classes.find(c => c.id === classId);
                return classItem ? classItem.name : 'Unknown Class';
            };

            return (
                <div className="space-y-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <div>
                            <h2 className="text-3xl font-bold text-white mb-2">📅 Schedule Management</h2>
                            <p className="text-blue-100">Manage your weekly class schedule</p>
                        </div>
                        <button
                            onClick={() => setShowAddForm(true)}
                            className="glass-button px-6 py-3 text-white font-semibold"
                            disabled={classes.length === 0}
                        >
                            ➕ Add Schedule
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    {error && (
                        <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                            {error}
                        </div>
                    )}

                    {classes.length === 0 && (
                        <div className="bg-yellow-500 bg-opacity-20 border border-yellow-300 text-yellow-100 px-4 py-3 rounded-lg">
                            ⚠️ You need to create classes first before scheduling them. Go to the Classes tab to add classes.
                        </div>
                    )}

                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-6">Weekly Schedule</h3>
                        
                        {isLoading ? (
                            <div className="text-center py-8">
                                <div className="text-blue-200">Loading schedules...</div>
                            </div>
                        ) : schedules.length === 0 ? (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">📅</div>
                                <div className="text-blue-200 text-lg mb-2">No schedules created yet</div>
                                <div className="text-blue-300 text-sm">Set up your weekly class schedule to get started!</div>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                {daysOfWeek.map((day, dayIndex) => {
                                    const daySchedules = schedules
                                        .filter(s => s.day_of_week === dayIndex)
                                        .sort((a, b) => a.start_time.localeCompare(b.start_time));
                                    
                                    return (
                                        <div key={day} className="bg-white bg-opacity-5 rounded-lg p-4">
                                            <h4 className="font-semibold text-white text-lg mb-3">
                                                {day}
                                            </h4>
                                            
                                            {daySchedules.length === 0 ? (
                                                <div className="text-blue-300 text-sm">No classes scheduled</div>
                                            ) : (
                                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                                    {daySchedules.map((schedule) => (
                                                        <div key={schedule.id} className="bg-white bg-opacity-10 rounded-lg p-3 relative group">
                                                            <button
                                                                onClick={() => handleDelete(schedule)}
                                                                className="absolute top-2 right-2 text-red-400 hover:text-red-300 opacity-0 group-hover:opacity-100 transition-opacity"
                                                                title="Delete schedule"
                                                            >
                                                                ❌
                                                            </button>
                                                            <div className="font-medium text-white pr-6">{getClassName(schedule.class_id)}</div>
                                                            <div className="text-blue-200 text-sm">
                                                                {formatTime(schedule.start_time)} - {formatTime(schedule.end_time)}
                                                            </div>
                                                            {schedule.instructor && (
                                                                <div className="text-blue-300 text-sm">
                                                                    👨‍🏫 {schedule.instructor}
                                                                </div>
                                                            )}
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>

                    {/* Add Schedule Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-bold text-white mb-4">Add New Schedule</h3>
                                
                                <form onSubmit={handleSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Class *</label>
                                        <select
                                            value={scheduleForm.class_id}
                                            onChange={(e) => setScheduleForm({...scheduleForm, class_id: e.target.value})}
                                            required
                                        >
                                            <option value="">Select a class</option>
                                            {classes.map(cls => (
                                                <option key={cls.id} value={cls.id}>{cls.name}</option>
                                            ))}
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Day of Week *</label>
                                        <select
                                            value={scheduleForm.day_of_week}
                                            onChange={(e) => setScheduleForm({...scheduleForm, day_of_week: parseInt(e.target.value)})}
                                            required
                                        >
                                            {daysOfWeek.map((day, index) => (
                                                <option key={index} value={index}>{day}</option>
                                            ))}
                                        </select>
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Start Time *</label>
                                            <input
                                                type="time"
                                                value={scheduleForm.start_time}
                                                onChange={(e) => setScheduleForm({...scheduleForm, start_time: e.target.value})}
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">End Time *</label>
                                            <input
                                                type="time"
                                                value={scheduleForm.end_time}
                                                onChange={(e) => setScheduleForm({...scheduleForm, end_time: e.target.value})}
                                                required
                                            />
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Instructor</label>
                                        <input
                                            type="text"
                                            value={scheduleForm.instructor}
                                            onChange={(e) => setScheduleForm({...scheduleForm, instructor: e.target.value})}
                                            placeholder="Instructor name"
                                        />
                                    </div>
                                    
                                    <div className="flex gap-3">
                                        <button
                                            type="submit"
                                            disabled={isLoading}
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            {isLoading ? 'Adding...' : 'Add Schedule'}
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setShowAddForm(false)}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Dashboard Component - PRODUCTION READY
        const Dashboard = ({ user, onLogout }) => {
            const [activeTab, setActiveTab] = useState('students');

            const tabs = [
                { id: 'students', label: 'Students', icon: '👥' },
                { id: 'classes', label: 'Classes', icon: '📚' },
                { id: 'schedule', label: 'Schedule', icon: '📅' },
                { id: 'attendance', label: 'Attendance', icon: '✅' },
                { id: 'analytics', label: 'Analytics', icon: '📊' },
                { id: 'risk-analysis', label: 'Risk Analysis', icon: '⚠️' },
                { id: 'communications', label: 'Communications', icon: '📧' },
                { id: 'system', label: 'System', icon: '🔧' }
            ];

            return (
                <div className="min-h-screen p-4">
                    <div className="max-w-7xl mx-auto">
                        <div className="glass-effect rounded-xl p-6 mb-6">
                            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-white mb-2">
                                        🥋 BJJProGym
                                        <span className="pro-badge ml-3">{user.plan}</span>
                                    </h1>
                                    <p className="text-blue-100">
                                        Welcome back, {user.name} • {user.gym_name}
                                    </p>
                                    <p className="text-blue-200 text-sm">
                                        Plan: {user.plan} • Status: ✅ Active
                                    </p>
                                </div>
                                <div className="flex flex-col sm:flex-row gap-3">
                                    <button
                                        onClick={() => setActiveTab('rfid-checkin')}
                                        className="glass-button px-6 py-3 text-white font-semibold"
                                    >
                                        🔍 RFID Check-In
                                    </button>
                                    <button
                                        onClick={onLogout}
                                        className="bg-red-500 bg-opacity-20 px-6 py-3 text-white font-semibold hover:bg-opacity-30"
                                    >
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="glass-effect rounded-xl p-2 mb-6">
                            <div className="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2">
                                {tabs.map((tab) => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-3 py-2 rounded-lg font-medium transition-colors text-sm ${
                                            activeTab === tab.id
                                                ? 'bg-blue-600 text-white'
                                                : 'text-blue-100 hover:bg-white hover:bg-opacity-10'
                                        }`}
                                    >
                                        <div className="text-lg mb-1">{tab.icon}</div>
                                        <div className="text-xs">{tab.label}</div>
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="min-h-96">
                            {activeTab === 'students' && <StudentManagement />}
                            {activeTab === 'classes' && <ClassesManagement />}
                            {activeTab === 'schedule' && <ScheduleManagement />}
                            {activeTab === 'attendance' && <AttendanceManagement />}
                            {activeTab === 'analytics' && <BusinessAnalytics />}
                            {activeTab === 'risk-analysis' && <RiskAnalysis />}
                            {activeTab === 'communications' && <Communications />}
                            {activeTab === 'system' && <SystemStatus />}
                            {activeTab === 'rfid-checkin' && <RFIDCheckIn />}
                        </div>
                    </div>
                </div>
            );
        };

        // RFID Check-In Component - PRODUCTION READY
        const RFIDCheckIn = () => {
            const [isListening, setIsListening] = useState(false);
            const [lastScan, setLastScan] = useState('');
            const [recentCheckIns, setRecentCheckIns] = useState([]);
            const [manualEntry, setManualEntry] = useState('');

            useEffect(() => {
                let scanBuffer = '';
                let scanTimeout;

                const handleKeyPress = (e) => {
                    if (!isListening) return;

                    // RFID scanners typically send data quickly followed by Enter
                    if (e.key === 'Enter') {
                        if (scanBuffer.length > 0) {
                            handleCardScan(scanBuffer);
                            scanBuffer = '';
                        }
                    } else {
                        scanBuffer += e.key;
                        
                        // Clear buffer if too much time passes (manual typing)
                        clearTimeout(scanTimeout);
                        scanTimeout = setTimeout(() => {
                            scanBuffer = '';
                        }, 100);
                    }
                };

                if (isListening) {
                    document.addEventListener('keypress', handleKeyPress);
                }

                return () => {
                    document.removeEventListener('keypress', handleKeyPress);
                    clearTimeout(scanTimeout);
                };
            }, [isListening]);

            const handleCardScan = async (cardNumber) => {
                setLastScan(cardNumber);
                
                try {
                    const result = await api.recordCheckIn({ card_number: cardNumber });
                    
                    setRecentCheckIns(prev => [{
                        id: Date.now(),
                        studentName: result.student_name || 'Unknown Student',
                        cardNumber: cardNumber,
                        timestamp: new Date().toLocaleString(),
                        status: 'success'
                    }, ...prev.slice(0, 9)]);
                    
                } catch (err) {
                    setRecentCheckIns(prev => [{
                        id: Date.now(),
                        studentName: 'Card Not Found',
                        cardNumber: cardNumber,
                        timestamp: new Date().toLocaleString(),
                        status: 'error'
                    }, ...prev.slice(0, 9)]);
                }
            };

            const handleManualCheckIn = async (e) => {
                e.preventDefault();
                if (!manualEntry.trim()) return;
                
                await handleCardScan(manualEntry);
                setManualEntry('');
            };

            return (
                <div className="space-y-6">
                    <div className="text-center">
                        <h2 className="text-3xl font-bold text-white mb-2">🔍 RFID Check-In Kiosk</h2>
                        <p className="text-blue-100">Professional card scanning system for student attendance</p>
                    </div>

                    {/* Scanner Status */}
                    <div className="glass-effect rounded-xl p-8 text-center">
                        <div className="mb-6">
                            <div className={`w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl mb-4 ${
                                isListening ? 'bg-green-500 bg-opacity-20 animate-pulse' : 'bg-gray-500 bg-opacity-20'
                            }`}>
                                {isListening ? '🟢' : '🔴'}
                            </div>
                            <h3 className="text-2xl font-bold text-white mb-2">
                                {isListening ? 'READY TO SCAN' : 'SCANNER OFFLINE'}
                            </h3>
                            <p className="text-blue-200">
                                {isListening ? 'Scan your card or enter manually below' : 'Click to activate card scanner'}
                            </p>
                        </div>

                        <button
                            onClick={() => setIsListening(!isListening)}
                            className={`glass-button px-8 py-4 text-white font-semibold text-lg ${
                                isListening ? 'bg-red-600' : 'bg-green-600'
                            }`}
                        >
                            {isListening ? '🛑 Stop Scanner' : '▶️ Start Scanner'}
                        </button>

                        {lastScan && (
                            <div className="mt-4 text-blue-200">
                                Last scan: <span className="font-mono text-white">{lastScan}</span>
                            </div>
                        )}
                    </div>

                    {/* Manual Entry */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">📝 Manual Card Entry</h3>
                        <form onSubmit={handleManualCheckIn} className="flex gap-3">
                            <input
                                type="text"
                                value={manualEntry}
                                onChange={(e) => setManualEntry(e.target.value)}
                                placeholder="Enter card number manually..."
                                className="flex-1"
                            />
                            <button
                                type="submit"
                                className="glass-button px-6 py-3 text-white font-semibold"
                            >
                                ✅ Check In
                            </button>
                        </form>
                    </div>

                    {/* Recent Check-Ins */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">📋 Recent Check-Ins</h3>
                        
                        {recentCheckIns.length === 0 ? (
                            <div className="text-center py-8">
                                <div className="text-6xl mb-4">📋</div>
                                <div className="text-blue-200">No check-ins recorded yet</div>
                                <div className="text-blue-300 text-sm">Check-ins will appear here in real-time</div>
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {recentCheckIns.map((checkIn) => (
                                    <div key={checkIn.id} className={`rounded-lg p-4 ${
                                        checkIn.status === 'success' 
                                            ? 'bg-green-500 bg-opacity-20 border border-green-300' 
                                            : 'bg-red-500 bg-opacity-20 border border-red-300'
                                    }`}>
                                        <div className="flex justify-between items-center">
                                            <div>
                                                <div className="font-semibold text-white">{checkIn.studentName}</div>
                                                <div className="text-sm opacity-75">Card: {checkIn.cardNumber}</div>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-sm">{checkIn.timestamp}</div>
                                                <div className={`text-sm font-semibold ${
                                                    checkIn.status === 'success' ? 'text-green-200' : 'text-red-200'
                                                }`}>
                                                    {checkIn.status === 'success' ? '✅ SUCCESS' : '❌ ERROR'}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Instructions */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">📖 Instructions</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-blue-100 text-sm">
                            <div>
                                <h4 className="font-semibold text-white mb-2">RFID Scanner Setup:</h4>
                                <ul className="space-y-1">
                                    <li>• Connect your USB RFID scanner</li>
                                    <li>• Configure as keyboard input device</li>
                                    <li>• Click "Start Scanner" to begin</li>
                                    <li>• Scanner will read cards automatically</li>
                                </ul>
                            </div>
                            <div>
                                <h4 className="font-semibold text-white mb-2">Manual Entry:</h4>
                                <ul className="space-y-1">
                                    <li>• Type card number in manual entry field</li>
                                    <li>• Press "Check In" button</li>
                                    <li>• Works for backup or testing</li>
                                    <li>• Compatible with any card format</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component - PRODUCTION SaaS
        const App = () => {
            const [user, setUser] = useState(null);
            const [currentView, setCurrentView] = useState('landing'); // landing, registration, verification, login, dashboard

            useEffect(() => {
                // Check for existing session
                const token = localStorage.getItem('auth_token');
                if (token) {
                    // Validate token with backend and set user if valid
                    validateSession(token);
                }
            }, []);

            const validateSession = async (token) => {
                try {
                    // This would validate the token with your backend
                    // For now, we'll assume it's valid and set a mock user
                    // In production, this would make an API call
                } catch (err) {
                    localStorage.removeItem('auth_token');
                }
            };

            const handleAccessValidated = (data) => {
                setCurrentView('registration');
            };

            const handleRegistered = (data) => {
                setCurrentView('verification');
            };

            const handleEmailVerified = (data) => {
                setUser(data.user);
                setCurrentView('dashboard');
            };

            const handleLogin = (userData) => {
                setUser(userData);
                setCurrentView('dashboard');
            };

            const handleLogout = () => {
                localStorage.removeItem('auth_token');
                setUser(null);
                setCurrentView('landing');
            };

            if (currentView === 'landing') {
                return <LandingPage onAccessValidated={handleAccessValidated} />;
            }

            if (currentView === 'verification') {
                return <EmailVerification email="test@example.com" onVerified={handleEmailVerified} />;
            }

            if (currentView === 'login') {
                return <Login onLogin={handleLogin} />;
            }

            if (currentView === 'dashboard' && user) {
                return <Dashboard user={user} onLogout={handleLogout} />;
            }

            return <LandingPage onAccessValidated={handleAccessValidated} />;
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
