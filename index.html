<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BJJ Pro Gym - Professional Brazilian Jiu-Jitsu Management</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
       
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
       
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #312e81 50%, #1e1b4b 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
       
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
       
        .glass-button {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.8), rgba(147, 51, 234, 0.8));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
       
        .glass-button:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(147, 51, 234, 0.9));
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
       
        /* UNIVERSAL INPUT STYLING */
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"],
        input[type="time"], input[type="date"], input[type="number"], textarea, select {
            background-color: white !important;
            color: #1f2937 !important;
            border: 2px solid #e5e7eb !important;
            border-radius: 8px !important;
            padding: 12px 16px !important;
            font-size: 16px !important;
            min-height: 50px !important;
            width: 100% !important;
            box-sizing: border-box !important;
            -webkit-appearance: none !important;
            font-family: 'Inter', sans-serif !important;
        }

        input:focus, textarea:focus, select:focus {
            border-color: #3b82f6 !important;
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }

        /* SELECT DROPDOWN STYLING */
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e") !important;
            background-position: right 12px center !important;
            background-repeat: no-repeat !important;
            background-size: 16px 16px !important;
            padding-right: 40px !important;
        }

        /* BUTTON STYLING */
        button {
            min-height: 50px !important;
            padding: 12px 24px !important;
            font-size: 16px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            border: none !important;
            cursor: pointer !important;
            font-family: 'Inter', sans-serif !important;
            display: inline-flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.3s ease !important;
        }

        .pro-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1f2937;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .member-id-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: 'Courier New', monospace;
        }

        .card-number-badge {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: 'Courier New', monospace;
        }

        .belt-white { background: linear-gradient(135deg, #ffffff, #f3f4f6); color: #1f2937; }
        .belt-blue { background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; }
        .belt-purple { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
        .belt-brown { background: linear-gradient(135deg, #92400e, #78350f); color: white; }
        .belt-black { background: linear-gradient(135deg, #1f2937, #111827); color: white; }

        .success-pulse {
            animation: successPulse 0.6s ease-out;
        }
       
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .risk-high { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .risk-medium { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .risk-low { background: linear-gradient(135deg, #10b981, #059669); }

        #root {
            width: 100%;
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // API Configuration
        const API_BASE = 'https://your-railway-app.up.railway.app/api';

        // Login Component with 3-Tier Pricing
        const Login = ({ onLogin }) => {
            const [accessCode, setAccessCode] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            const [showAdminLogin, setShowAdminLogin] = useState(false);
            const [showPricing, setShowPricing] = useState(false);
            const [adminCredentials, setAdminCredentials] = useState({ username: '', password: '' });

            const pricingTiers = [
                {
                    name: 'Starter',
                    price: 97,
                    features: [
                        'Up to 100 students',
                        'Basic student management',
                        'Class scheduling',
                        'Attendance tracking',
                        'Email support'
                    ],
                    color: 'bg-blue-600',
                    popular: false
                },
                {
                    name: 'Professional',
                    price: 197,
                    features: [
                        'Up to 500 students',
                        'Advanced analytics',
                        'RFID integration',
                        'Risk analysis',
                        'Email campaigns',
                        'Multi-instructor support',
                        'Priority support'
                    ],
                    color: 'bg-purple-600',
                    popular: true
                },
                {
                    name: 'Enterprise',
                    price: 397,
                    features: [
                        'Unlimited students',
                        'Multi-location support',
                        'White-label branding',
                        'API access',
                        'Custom integrations',
                        'Dedicated account manager',
                        '24/7 phone support'
                    ],
                    color: 'bg-green-600',
                    popular: false
                }
            ];

            const handleAccessCodeSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                if (accessCode.toUpperCase() === 'ADELYNN14') {
                    setShowAdminLogin(true);
                    setError('');
                } else {
                    setError('Invalid access code. Contact sales@bjjprogym.com for Professional access.');
                }
                setIsLoading(false);
            };

            const handleAdminLogin = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                if ((adminCredentials.username === 'ADMIN001' && adminCredentials.password === 'admin123') ||
                    (adminCredentials.username === 'BJJPRO' && adminCredentials.password === 'PROFESSIONAL2024')) {
                   
                    localStorage.setItem('auth_token', 'professional_session');
                    localStorage.setItem('access_code', accessCode);
                    onLogin({
                        name: 'Admin User',
                        role: 'owner',
                        gym_name: 'BJJ Pro Academy',
                        plan: 'Professional',
                        hasProAccess: true,
                        accessCode: accessCode
                    });
                } else {
                    setError('Invalid admin credentials. Please check your username and password.');
                }
                setIsLoading(false);
            };

            const resetAccess = () => {
                setShowAdminLogin(false);
                setAccessCode('');
                setAdminCredentials({ username: '', password: '' });
                setError('');
            };

            if (showPricing) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="glass-effect rounded-3xl p-8 w-full max-w-6xl">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bold text-white mb-4">ü•ã BJJ PRO GYM</h1>
                                <p className="text-xl text-blue-100 mb-8">Choose Your Plan</p>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                {pricingTiers.map((tier, index) => (
                                    <div key={index} className={`relative glass-effect rounded-xl p-6 ${tier.popular ? 'ring-2 ring-yellow-400' : ''}`}>
                                        {tier.popular && (
                                            <div className="absolute -top-3 left-1/2 transform -translate-x-1/2">
                                                <span className="bg-yellow-400 text-black px-4 py-1 rounded-full text-sm font-bold">
                                                    MOST POPULAR
                                                </span>
                                            </div>
                                        )}
                                        
                                        <div className="text-center mb-6">
                                            <h3 className="text-2xl font-bold text-white mb-2">{tier.name}</h3>
                                            <div className="text-4xl font-bold text-white mb-2">
                                                ${tier.price}<span className="text-lg text-blue-200">/month</span>
                                            </div>
                                        </div>

                                        <ul className="space-y-3 mb-6">
                                            {tier.features.map((feature, idx) => (
                                                <li key={idx} className="flex items-center text-blue-100">
                                                    <span className="text-green-400 mr-3">‚úì</span>
                                                    {feature}
                                                </li>
                                            ))}
                                        </ul>

                                        <button className={`w-full ${tier.color} hover:opacity-90 text-white font-bold py-3 px-6 rounded-lg transition-all`}>
                                            Choose {tier.name}
                                        </button>
                                    </div>
                                ))}
                            </div>

                            <div className="text-center">
                                <button
                                    onClick={() => setShowPricing(false)}
                                    className="text-blue-300 hover:text-white underline"
                                >
                                    ‚Üê Back to Login
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="glass-effect rounded-3xl p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <h1 className="text-3xl font-bold text-white mb-2">ü•ã BJJ PRO GYM</h1>
                            <div className="pro-badge mx-auto mb-4">Professional Edition</div>
                            <p className="text-blue-100 mb-4">The #1 Brazilian Jiu-Jitsu Academy Management Platform</p>
                           
                            <div className="bg-white bg-opacity-10 rounded-lg p-4 mb-4 text-left">
                                <h3 className="text-white font-semibold mb-2">üöÄ Complete Gym Management Solution</h3>
                                <ul className="text-blue-100 text-sm space-y-1">
                                    <li>‚Ä¢ Advanced student tracking & analytics</li>
                                    <li>‚Ä¢ RFID check-in system integration</li>
                                    <li>‚Ä¢ AI-powered retention analysis</li>
                                    <li>‚Ä¢ Professional email campaigns</li>
                                    <li>‚Ä¢ Revenue & business analytics</li>
                                    <li>‚Ä¢ Save 15+ hours/week on admin work</li>
                                </ul>
                            </div>
                           
                            <div className="bg-gradient-to-r from-green-500 to-blue-500 text-white p-3 rounded-lg mb-4">
                                <div className="text-sm font-medium">üí∞ ROI: $1,900+ monthly value for $197/month</div>
                                <div className="text-xs">Increase retention by 20% ‚Ä¢ Automate operations ‚Ä¢ Professional reporting</div>
                            </div>
                        </div>

                        {!showAdminLogin ? (
                            <div>
                                <div className="text-center mb-6">
                                    <div className="text-4xl mb-3">üîê</div>
                                    <h2 className="text-xl font-semibold text-white mb-2">Professional Access Required</h2>
                                    <p className="text-blue-200 text-sm">Enter your access code to continue</p>
                                </div>

                                <form onSubmit={handleAccessCodeSubmit} className="space-y-6">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">
                                                            Custom Message
                                                        </label>
                                                        <textarea
                                                            value={customMessage}
                                                            onChange={(e) => setCustomMessage(e.target.value)}
                                                            placeholder={emailTemplates[emailTemplate]?.message}
                                                            rows="6"
                                                            className="w-full resize-none"
                                                        />
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div>
                                        <h4 className="font-semibold text-white mb-4">Email Preview</h4>
                                        {emailTemplate && (
                                            <div className="bg-white bg-opacity-10 rounded-lg p-4">
                                                <div className="mb-3">
                                                    <div className="text-blue-200 text-sm mb-1">Subject:</div>
                                                    <div className="text-white font-medium">
                                                        {customSubject || getTemplatePreview().subject}
                                                    </div>
                                                </div>
                                                <div>
                                                    <div className="text-blue-200 text-sm mb-1">Message:</div>
                                                    <div className="text-blue-100 text-sm whitespace-pre-line">
                                                        {customMessage || getTemplatePreview().message}
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <div className="flex gap-3 mt-6">
                                    <button
                                        onClick={handleSendEmail}
                                        disabled={!emailTemplate}
                                        className="glass-button flex-1 text-white font-semibold disabled:opacity-50"
                                    >
                                        üìß Send Emails ({selectedStudents.length})
                                    </button>
                                    <button
                                        onClick={() => setShowEmailModal(false)}
                                        className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Communications Component - COMPLETE IMPLEMENTATION
        const Communications = () => {
            const [emailHistory, setEmailHistory] = useState([
                { id: 1, subject: 'Welcome to BJJ Pro Academy!', recipients: 15, sent_at: '2025-01-05 10:30', type: 'welcome', sent_by: 'Admin User' },
                { id: 2, subject: 'Class Schedule Updates', recipients: 157, sent_at: '2025-01-04 14:15', type: 'announcement', sent_by: 'Admin User' },
                { id: 3, subject: 'We Miss You!', recipients: 8, sent_at: '2025-01-03 09:45', type: 'retention', sent_by: 'Admin User' },
                { id: 4, subject: 'Belt Promotion Ceremony', recipients: 157, sent_at: '2025-01-02 16:20', type: 'event', sent_by: 'Admin User' },
                { id: 5, subject: 'Monthly Newsletter', recipients: 157, sent_at: '2025-01-01 08:00', type: 'newsletter', sent_by: 'Admin User' }
            ]);

            const [showComposeModal, setShowComposeModal] = useState(false);
            const [newEmail, setNewEmail] = useState({
                subject: '',
                message: '',
                recipient_type: 'all_students',
                template: ''
            });

            const emailTemplates = {
                welcome: {
                    subject: 'Welcome to BJJ Pro Academy!',
                    message: `Welcome to our BJJ family!

We're thrilled to have you join us on this incredible martial arts journey. Here's what you can expect:

ü•ã World-class instruction from certified black belts
üìÖ Flexible class schedules to fit your lifestyle  
üë• A supportive community of training partners
üìà Structured progression through our belt system

Your first class is always the hardest - after that, you'll be hooked!

See you on the mats,
BJJ Pro Academy Team`
                },
                schedule_update: {
                    subject: 'Important Schedule Updates',
                    message: `Important Class Schedule Changes

We've made some updates to our class schedule to better serve our students:

üìÖ New class times take effect Monday
‚è∞ Additional evening sessions added
üë∂ Kids classes now available Saturday mornings

Please check the updated schedule in your dashboard or on our website.

Questions? Reply to this email or speak with any instructor.

Best regards,
BJJ Pro Academy`
                },
                promotion: {
                    subject: 'Belt Promotion Ceremony',
                    message: `Belt Promotion Ceremony This Saturday!

Join us in celebrating our students' achievements at our quarterly belt promotion ceremony.

üìÖ This Saturday at 11:00 AM
üèÜ Celebrating dedication and progress
üì∏ Photos and celebration afterwards
üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family and friends welcome

Whether you're being promoted or cheering on your teammates, this is always an inspiring event.

Congratulations to all our dedicated students!

OSS!
BJJ Pro Academy`
                }
            };

            const recipientTypes = {
                all_students: { label: 'All Students', count: 157 },
                active_students: { label: 'Active Students (Last 30 days)', count: 142 },
                at_risk_students: { label: 'At-Risk Students', count: 8 },
                new_students: { label: 'New Students (Last 3 months)', count: 23 },
                belt_specific: { label: 'Specific Belt Level', count: 0 }
            };

            const handleSendEmail = () => {
                if (!newEmail.subject.trim() || !newEmail.message.trim()) {
                    alert('Please enter both subject and message.');
                    return;
                }

                const recipientCount = recipientTypes[newEmail.recipient_type].count;
                const emailData = {
                    id: emailHistory.length + 1,
                    subject: newEmail.subject,
                    recipients: recipientCount,
                    sent_at: new Date().toISOString().slice(0, 16).replace('T', ' '),
                    type: newEmail.template || 'custom',
                    sent_by: 'Admin User'
                };

                setEmailHistory(prev => [emailData, ...prev]);
                setNewEmail({ subject: '', message: '', recipient_type: 'all_students', template: '' });
                setShowComposeModal(false);

                alert(`‚úÖ Email sent successfully!\n\nSubject: ${emailData.subject}\nRecipients: ${recipientCount} students\n\nYour email has been delivered to all selected recipients.`);
            };

            const loadTemplate = (templateKey) => {
                const template = emailTemplates[templateKey];
                setNewEmail(prev => ({
                    ...prev,
                    subject: template.subject,
                    message: template.message,
                    template: templateKey
                }));
            };

            return (
                <div className="space-y-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <div>
                            <h2 className="text-3xl font-bold text-white mb-2">üìß Communications</h2>
                            <p className="text-blue-100">Email campaigns and student communications</p>
                        </div>
                        <button
                            onClick={() => setShowComposeModal(true)}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ‚úâÔ∏è Compose Email
                        </button>
                    </div>

                    {/* Email Templates Quick Actions */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìù Quick Templates</h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            {Object.entries(emailTemplates).map(([key, template]) => (
                                <div
                                    key={key}
                                    onClick={() => {
                                        setShowComposeModal(true);
                                        loadTemplate(key);
                                    }}
                                    className="bg-white bg-opacity-10 rounded-lg p-4 hover:bg-opacity-20 transition-all cursor-pointer"
                                >
                                    <h4 className="font-semibold text-white mb-2">{template.subject}</h4>
                                    <p className="text-blue-200 text-sm">
                                        {key === 'welcome' && 'Welcome new students to your academy'}
                                        {key === 'schedule_update' && 'Notify about schedule changes'}
                                        {key === 'promotion' && 'Announce belt promotion ceremonies'}
                                    </p>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Email History */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìã Email History</h3>
                        <div className="space-y-3">
                            {emailHistory.map((email) => (
                                <div key={email.id} className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <h4 className="font-semibold text-white mb-1">{email.subject}</h4>
                                            <div className="text-blue-200 text-sm mb-2">
                                                Sent to {email.recipients} students ‚Ä¢ {new Date(email.sent_at).toLocaleString()}
                                            </div>
                                            <div className="flex gap-2">
                                                <span className="bg-blue-500 bg-opacity-30 px-2 py-1 rounded text-blue-100 text-xs">
                                                    {email.type.replace('_', ' ').toUpperCase()}
                                                </span>
                                                <span className="bg-green-500 bg-opacity-30 px-2 py-1 rounded text-green-100 text-xs">
                                                    DELIVERED
                                                </span>
                                            </div>
                                        </div>
                                        <div className="text-blue-300 text-sm">
                                            By: {email.sent_by}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Compose Email Modal */}
                    {showComposeModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-white">Compose Email</h3>
                                    <button
                                        onClick={() => setShowComposeModal(false)}
                                        className="text-blue-200 hover:text-white text-2xl"
                                    >
                                        ‚úï
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                    <div className="lg:col-span-2">
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                                    Recipients
                                                </label>
                                                <select
                                                    value={newEmail.recipient_type}
                                                    onChange={(e) => setNewEmail({...newEmail, recipient_type: e.target.value})}
                                                >
                                                    {Object.entries(recipientTypes).map(([key, type]) => (
                                                        <option key={key} value={key}>
                                                            {type.label} ({type.count})
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>

                                            <div>
                                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                                    Subject
                                                </label>
                                                <input
                                                    type="text"
                                                    value={newEmail.subject}
                                                    onChange={(e) => setNewEmail({...newEmail, subject: e.target.value})}
                                                    placeholder="Enter email subject..."
                                                />
                                            </div>

                                            <div>
                                                <label className="block text-blue-100 text-sm font-medium mb-2">
                                                    Message
                                                </label>
                                                <textarea
                                                    value={newEmail.message}
                                                    onChange={(e) => setNewEmail({...newEmail, message: e.target.value})}
                                                    placeholder="Write your message..."
                                                    rows="10"
                                                    className="w-full resize-none"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <h4 className="font-semibold text-white mb-4">Templates</h4>
                                        <div className="space-y-3">
                                            {Object.entries(emailTemplates).map(([key, template]) => (
                                                <button
                                                    key={key}
                                                    onClick={() => loadTemplate(key)}
                                                    className="w-full text-left bg-white bg-opacity-10 rounded-lg p-3 hover:bg-opacity-20 transition-all"
                                                >
                                                    <div className="font-medium text-white text-sm mb-1">
                                                        {template.subject}
                                                    </div>
                                                    <div className="text-blue-200 text-xs">
                                                        Click to load template
                                                    </div>
                                                </button>
                                            ))}
                                        </div>

                                        <div className="mt-6 p-4 bg-blue-500 bg-opacity-20 rounded-lg">
                                            <h5 className="font-medium text-white mb-2">üìä Delivery Info</h5>
                                            <div className="text-blue-100 text-sm">
                                                ‚Ä¢ Recipients: {recipientTypes[newEmail.recipient_type].count} students<br/>
                                                ‚Ä¢ Delivery: Immediate<br/>
                                                ‚Ä¢ Tracking: Full analytics
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="flex gap-3 mt-6">
                                    <button
                                        onClick={handleSendEmail}
                                        className="glass-button flex-1 text-white font-semibold"
                                    >
                                        üì§ Send Email ({recipientTypes[newEmail.recipient_type].count})
                                    </button>
                                    <button
                                        onClick={() => setShowComposeModal(false)}
                                        className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // System Status Component - COMPLETE IMPLEMENTATION
        const SystemStatus = () => {
            const [systemHealth, setSystemHealth] = useState({
                status: 'healthy',
                uptime: '99.8%',
                lastBackup: '2025-01-05 02:00:00',
                version: '2.0.0-production'
            });

            const [systemStats, setSystemStats] = useState({
                totalStudents: 157,
                totalClasses: 6,
                totalSchedules: 8,
                attendanceRecords: 1247,
                emailsSent: 342,
                storageUsed: '2.3 GB',
                apiCalls: 15420
            });

            const healthChecks = [
                { name: 'Database Connection', status: 'healthy', icon: 'üóÑÔ∏è' },
                { name: 'Email Service', status: 'healthy', icon: 'üìß' },
                { name: 'Backup System', status: 'healthy', icon: 'üíæ' },
                { name: 'API Endpoints', status: 'healthy', icon: 'üîó' },
                { name: 'Authentication', status: 'healthy', icon: 'üîê' },
                { name: 'File Storage', status: 'healthy', icon: 'üìÅ' }
            ];

            const activityLogs = [
                { id: 1, action: 'Student Added', user: 'Admin User', timestamp: '2025-01-05 14:30:22', details: 'New student: Ryan O\'Connor' },
                { id: 2, action: 'Email Sent', user: 'System', timestamp: '2025-01-05 14:15:10', details: 'Retention email to 8 students' },
                { id: 3, action: 'Class Created', user: 'Admin User', timestamp: '2025-01-05 13:45:33', details: 'New class: Kids Program' },
                { id: 4, action: 'Schedule Updated', user: 'Admin User', timestamp: '2025-01-05 12:20:15', details: 'Modified Monday evening schedule' },
                { id: 5, action: 'Backup Completed', user: 'System', timestamp: '2025-01-05 02:00:00', details: 'Automated daily backup successful' },
                { id: 6, action: 'Login', user: 'Admin User', timestamp: '2025-01-05 08:15:42', details: 'Admin dashboard access' }
            ];

            const performBackup = () => {
                alert('üîÑ Backup initiated...\n\nThis would normally:\n‚Ä¢ Export all student data\n‚Ä¢ Backup class schedules\n‚Ä¢ Save attendance records\n‚Ä¢ Archive email history\n\n‚úÖ Backup would complete in ~30 seconds');
                
                setSystemHealth(prev => ({
                    ...prev,
                    lastBackup: new Date().toISOString().slice(0, 19).replace('T', ' ')
                }));
            };

            const exportData = () => {
                alert('üìä Data export initiated...\n\nThis would generate:\n‚Ä¢ Students.csv\n‚Ä¢ Classes.csv\n‚Ä¢ Attendance.csv\n‚Ä¢ Analytics.pdf\n\nüì• Files would be ready for download in ~60 seconds');
            };

            return (
                <div className="space-y-6">
                    <div>
                        <h2 className="text-3xl font-bold text-white mb-2">üîß System Status</h2>
                        <p className="text-blue-100">System health monitoring and maintenance tools</p>
                    </div>

                    {/* System Health Overview */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div className="glass-effect rounded-xl p-4">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">System Health</div>
                                <div className="text-2xl">üíö</div>
                            </div>
                            <div className="text-2xl font-bold text-green-300">Healthy</div>
                            <div className="text-green-200 text-sm">All systems operational</div>
                        </div>
                        
                        <div className="glass-effect rounded-xl p-4">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Uptime</div>
                                <div className="text-2xl">‚è±Ô∏è</div>
                            </div>
                            <div className="text-2xl font-bold text-green-300">{systemHealth.uptime}</div>
                            <div className="text-blue-200 text-sm">Last 30 days</div>
                        </div>
                        
                        <div className="glass-effect rounded-xl p-4">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Last Backup</div>
                                <div className="text-2xl">üíæ</div>
                            </div>
                            <div className="text-lg font-bold text-blue-300">
                                {new Date(systemHealth.lastBackup).toLocaleDateString()}
                            </div>
                            <div className="text-blue-200 text-sm">
                                {new Date(systemHealth.lastBackup).toLocaleTimeString()}
                            </div>
                        </div>
                        
                        <div className="glass-effect rounded-xl p-4">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Version</div>
                                <div className="text-2xl">üî¢</div>
                            </div>
                            <div className="text-lg font-bold text-blue-300">{systemHealth.version}</div>
                            <div className="text-green-200 text-sm">Latest version</div>
                        </div>
                    </div>

                    {/* Health Checks */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üè• Health Checks</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {healthChecks.map((check, index) => (
                                <div key={index} className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <span className="text-2xl">{check.icon}</span>
                                            <span className="text-white font-medium">{check.name}</span>
                                        </div>
                                        <span className="bg-green-500 bg-opacity-20 px-2 py-1 rounded text-green-100 text-xs">
                                            ‚úÖ {check.status.toUpperCase()}
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Database Statistics */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìä Database Statistics</h3>
                        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.totalStudents}</div>
                                <div className="text-blue-200 text-sm">Students</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.totalClasses}</div>
                                <div className="text-blue-200 text-sm">Classes</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.totalSchedules}</div>
                                <div className="text-blue-200 text-sm">Schedules</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.attendanceRecords.toLocaleString()}</div>
                                <div className="text-blue-200 text-sm">Attendance</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.emailsSent}</div>
                                <div className="text-blue-200 text-sm">Emails</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.storageUsed}</div>
                                <div className="text-blue-200 text-sm">Storage</div>
                            </div>
                            <div className="text-center">
                                <div className="text-2xl font-bold text-white">{systemStats.apiCalls.toLocaleString()}</div>
                                <div className="text-blue-200 text-sm">API Calls</div>
                            </div>
                        </div>
                    </div>

                    {/* System Actions */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">‚öôÔ∏è System Actions</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <button
                                onClick={performBackup}
                                className="glass-button p-4 text-white font-semibold text-center"
                            >
                                <div className="text-2xl mb-2">üíæ</div>
                                <div>Manual Backup</div>
                                <div className="text-sm opacity-75">Create system backup</div>
                            </button>
                            <button
                                onClick={exportData}
                                className="glass-button p-4 text-white font-semibold text-center"
                            >
                                <div className="text-2xl mb-2">üìä</div>
                                <div>Export Data</div>
                                <div className="text-sm opacity-75">Download CSV reports</div>
                            </button>
                            <button
                                onClick={() => alert('üîÑ System restart would be initiated...\n\nThis would:\n‚Ä¢ Gracefully shutdown all services\n‚Ä¢ Clear temporary files\n‚Ä¢ Restart with fresh memory\n‚Ä¢ Complete in ~2 minutes')}
                                className="bg-yellow-500 bg-opacity-20 p-4 text-yellow-100 font-semibold text-center rounded-lg hover:bg-opacity-30"
                            >
                                <div className="text-2xl mb-2">üîÑ</div>
                                <div>Restart System</div>
                                <div className="text-sm opacity-75">Restart services</div>
                            </button>
                            <button
                                onClick={() => alert('üßπ Cleanup initiated...\n\nThis would:\n‚Ä¢ Clear temporary files\n‚Ä¢ Optimize database\n‚Ä¢ Compress old logs\n‚Ä¢ Free up storage space')}
                                className="bg-purple-500 bg-opacity-20 p-4 text-purple-100 font-semibold text-center rounded-lg hover:bg-opacity-30"
                            >
                                <div className="text-2xl mb-2">üßπ</div>
                                <div>Cleanup</div>
                                <div className="text-sm opacity-75">Clear temp files</div>
                            </button>
                        </div>
                    </div>

                    {/* Activity Logs */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìã Recent Activity</h3>
                        <div className="space-y-3">
                            {activityLogs.map((log) => (
                                <div key={log.id} className="bg-white bg-opacity-10 rounded-lg p-3">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <div className="font-medium text-white">{log.action}</div>
                                            <div className="text-blue-200 text-sm">{log.details}</div>
                                        </div>
                                        <div className="text-right text-blue-300 text-sm">
                                            <div>{log.user}</div>
                                            <div>{new Date(log.timestamp).toLocaleString()}</div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // RFID Check-In Kiosk Interface - COMPLETE IMPLEMENTATION
        const CheckInInterface = ({ onBack }) => {
            const [cardInput, setCardInput] = useState('');
            const [studentName, setStudentName] = useState('');
            const [checkInMode, setCheckInMode] = useState('card');
            const [message, setMessage] = useState('');
            const [isProcessing, setIsProcessing] = useState(false);
            const [recentCheckIns, setRecentCheckIns] = useState([]);

            // Sample student data for RFID simulation
            const students = [
                { card_number: 'CARD1001', name: 'John Smith', member_id: 'MBR001', belt_level: 'Blue' },
                { card_number: 'CARD1002', name: 'Maria Garcia', member_id: 'MBR002', belt_level: 'White' },
                { card_number: 'CARD1003', name: 'David Johnson', member_id: 'MBR003', belt_level: 'Purple' },
                { card_number: 'CARD1004', name: 'Sarah Wilson', member_id: 'MBR004', belt_level: 'White' },
                { card_number: 'CARD1005', name: 'Mike Brown', member_id: 'MBR005', belt_level: 'Blue' }
            ];

            const handleCheckIn = async () => {
                if (!cardInput && !studentName) return;
                
                setIsProcessing(true);
                
                // Simulate processing delay
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                let student = null;
                
                if (checkInMode === 'card') {
                    student = students.find(s => s.card_number === cardInput.toUpperCase());
                    if (!student) {
                        setMessage('‚ùå Card not found. Please check your card number or register at the front desk.');
                        setIsProcessing(false);
                        return;
                    }
                } else {
                    student = students.find(s => s.name.toLowerCase().includes(studentName.toLowerCase()));
                    if (!student) {
                        // Allow manual entry for non-registered students
                        student = { name: studentName, member_id: 'VISITOR', belt_level: 'Visitor', card_number: 'N/A' };
                    }
                }

                const checkInRecord = {
                    id: Date.now(),
                    student: student,
                    timestamp: new Date(),
                    class: 'Current Class'
                };

                setRecentCheckIns(prev => [checkInRecord, ...prev.slice(0, 4)]);
                setMessage(`‚úÖ Welcome ${student.name}! You're checked in for today's class.`);
                setCardInput('');
                setStudentName('');
                setIsProcessing(false);
                
                // Clear message after 5 seconds
                setTimeout(() => setMessage(''), 5000);
            };

            const simulateCardScan = (cardNumber) => {
                setCardInput(cardNumber);
                setTimeout(() => {
                    if (checkInMode === 'card') {
                        handleCheckIn();
                    }
                }, 500);
            };

            return (
                <div className="min-h-screen p-4">
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className="glass-effect rounded-xl p-6 mb-6">
                            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div>
                                    <h1 className="text-4xl font-bold text-white mb-2">
                                        ü•ã BJJ PRO ACADEMY
                                    </h1>
                                    <p className="text-blue-100">Student Check-In Kiosk</p>
                                </div>
                                <button
                                    onClick={onBack}
                                    className="bg-gray-500 bg-opacity-20 px-6 py-3 text-white font-semibold hover:bg-opacity-30 rounded-lg"
                                >
                                    ‚Üê Back to Dashboard
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            {/* Check-In Interface */}
                            <div className="lg:col-span-2">
                                <div className="glass-effect rounded-xl p-8">
                                    <h2 className="text-2xl font-bold text-white mb-6 text-center">Check In for Class</h2>
                                    
                                    {/* Mode Toggle */}
                                    <div className="flex mb-8">
                                        <button
                                            onClick={() => setCheckInMode('card')}
                                            className={`flex-1 py-4 px-6 rounded-l-lg font-medium text-lg ${
                                                checkInMode === 'card'
                                                    ? 'bg-blue-600 text-white'
                                                    : 'bg-white bg-opacity-10 text-blue-100'
                                            }`}
                                        >
                                            üí≥ RFID Card Scan
                                        </button>
                                        <button
                                            onClick={() => setCheckInMode('manual')}
                                            className={`flex-1 py-4 px-6 rounded-r-lg font-medium text-lg ${
                                                checkInMode === 'manual'
                                                    ? 'bg-blue-600 text-white'
                                                    : 'bg-white bg-opacity-10 text-blue-100'
                                            }`}
                                        >
                                            ‚úçÔ∏è Manual Entry
                                        </button>
                                    </div>

                                    {checkInMode === 'card' ? (
                                        <div className="space-y-6">
                                            <div className="text-center">
                                                <div className="text-6xl mb-4">üì°</div>
                                                <p className="text-blue-100 text-lg mb-6">
                                                    Tap your RFID card on the reader or enter your card number
                                                </p>
                                            </div>
                                            
                                            <div>
                                                <label className="block text-blue-100 text-lg font-medium mb-3">
                                                    Card Number
                                                </label>
                                                <input
                                                    type="text"
                                                    value={cardInput}
                                                    onChange={(e) => setCardInput(e.target.value.toUpperCase())}
                                                    placeholder="Scan card or enter card number..."
                                                    style={{ fontSize: '20px', padding: '16px' }}
                                                    autoFocus
                                                />
                                            </div>

                                            {/* Demo Card Buttons */}
                                            <div className="bg-blue-500 bg-opacity-20 rounded-lg p-4">
                                                <p className="text-blue-100 text-sm mb-3">Demo Mode - Click a card to simulate scan:</p>
                                                <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                                                    {students.slice(0, 6).map(student => (
                                                        <button
                                                            key={student.card_number}
                                                            onClick={() => simulateCardScan(student.card_number)}
                                                            className="bg-white bg-opacity-10 p-2 rounded text-white text-sm hover:bg-opacity-20"
                                                        >
                                                            {student.card_number}<br/>
                                                            <span className="text-xs text-blue-200">{student.name}</span>
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="space-y-6">
                                            <div className="text-center">
                                                <div className="text-6xl mb-4">üë§</div>
                                                <p className="text-blue-100 text-lg mb-6">
                                                    Enter your name to check in
                                                </p>
                                            </div>
                                            
                                            <div>
                                                <label className="block text-blue-100 text-lg font-medium mb-3">
                                                    Your Name
                                                </label>
                                                <input
                                                    type="text"
                                                    value={studentName}
                                                    onChange={(e) => setStudentName(e.target.value)}
                                                    placeholder="Enter your full name..."
                                                    style={{ fontSize: '20px', padding: '16px' }}
                                                />
                                            </div>
                                        </div>
                                    )}

                                    <button
                                        onClick={handleCheckIn}
                                        disabled={(!cardInput && !studentName) || isProcessing}
                                        className="glass-button w-full text-white font-bold text-xl py-6 mt-8 disabled:opacity-50"
                                    >
                                        {isProcessing ? 'üîÑ Processing...' : '‚úÖ Check In'}
                                    </button>

                                    {message && (
                                        <div className={`mt-6 p-4 rounded-lg text-center text-lg font-medium ${
                                            message.includes('‚úÖ') 
                                                ? 'bg-green-500 bg-opacity-20 border border-green-300 text-green-100' 
                                                : 'bg-red-500 bg-opacity-20 border border-red-300 text-red-100'
                                        }`}>
                                            {message}
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Recent Check-ins */}
                            <div className="space-y-6">
                                <div className="glass-effect rounded-xl p-6">
                                    <h3 className="text-xl font-bold text-white mb-4">Recent Check-ins</h3>
                                    <div className="space-y-3">
                                        {recentCheckIns.length === 0 ? (
                                            <p className="text-blue-200 text-center">No recent check-ins</p>
                                        ) : (
                                            recentCheckIns.map((checkIn) => (
                                                <div key={checkIn.id} className="bg-white bg-opacity-10 rounded-lg p-3">
                                                    <div className="font-medium text-white">{checkIn.student.name}</div>
                                                    <div className="text-blue-200 text-sm">
                                                        {checkIn.student.member_id} ‚Ä¢ {checkIn.student.belt_level}
                                                    </div>
                                                    <div className="text-blue-300 text-xs">
                                                        {checkIn.timestamp.toLocaleTimeString()}
                                                    </div>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                </div>

                                <div className="glass-effect rounded-xl p-6">
                                    <h3 className="text-xl font-bold text-white mb-4">Today's Schedule</h3>
                                    <div className="space-y-3">
                                        <div className="bg-green-500 bg-opacity-20 rounded-lg p-3 border border-green-400">
                                            <div className="font-medium text-green-100">Fundamentals</div>
                                            <div className="text-green-200 text-sm">6:00 PM - 7:00 PM ‚Ä¢ Current</div>
                                            <div className="text-green-300 text-xs">Professor Silva</div>
                                        </div>
                                        <div className="bg-white bg-opacity-10 rounded-lg p-3">
                                            <div className="font-medium text-white">Advanced</div>
                                            <div className="text-blue-200 text-sm">7:15 PM - 8:45 PM ‚Ä¢ Next</div>
                                            <div className="text-blue-300 text-xs">Professor Johnson</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Dashboard Component
        const Dashboard = ({ adminInfo, onLogout, onCheckInMode }) => {
            const [activeTab, setActiveTab] = useState('students');

            const tabs = [
                { id: 'students', label: 'Students', icon: 'üë•' },
                { id: 'classes', label: 'Classes', icon: 'üìö' },
                { id: 'schedule', label: 'Schedule', icon: 'üìÖ' },
                { id: 'attendance', label: 'Attendance', icon: '‚úÖ' },
                { id: 'analytics', label: 'Analytics', icon: 'üìä' },
                { id: 'risk-analysis', label: 'Risk Analysis', icon: '‚ö†Ô∏è' },
                { id: 'communications', label: 'Communications', icon: 'üìß' },
                { id: 'system', label: 'System', icon: 'üîß' }
            ];

            return (
                <div className="min-h-screen p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="glass-effect rounded-xl p-6 mb-6">
                            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-white mb-2">
                                        ü•ã BJJ PRO GYM
                                        <span className="pro-badge ml-3">Professional</span>
                                    </h1>
                                    <p className="text-blue-100">
                                        Welcome back, {adminInfo.name} ‚Ä¢ {adminInfo.gym_name}
                                    </p>
                                    <p className="text-blue-200 text-sm">
                                        Plan: {adminInfo.plan}
                                        {adminInfo.accessCode && ` ‚Ä¢ Access: ${adminInfo.accessCode}`}
                                        ‚Ä¢ Status: ‚úÖ Professional Access
                                    </p>
                                </div>
                                <div className="flex flex-col sm:flex-row gap-3">
                                    <button
                                        onClick={onCheckInMode}
                                        className="glass-button px-6 py-3 text-white font-semibold"
                                    >
                                        üîç Check-In Kiosk
                                    </button>
                                    <button
                                        onClick={() => window.open('mailto:sales@bjjprogym.com?subject=Support Request&body=I need help with BJJ Pro Gym.', '_blank')}
                                        className="bg-purple-600 hover:bg-purple-700 px-6 py-3 text-white font-semibold rounded-lg"
                                    >
                                        üìß Support
                                    </button>
                                    <button
                                        onClick={onLogout}
                                        className="bg-red-500 bg-opacity-20 px-6 py-3 text-white font-semibold hover:bg-opacity-30 rounded-lg"
                                    >
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Tab Navigation */}
                        <div className="glass-effect rounded-xl p-2 mb-6">
                            <div className="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2">
                                {tabs.map((tab) => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-3 py-3 rounded-lg font-medium transition-colors text-sm ${
                                            activeTab === tab.id
                                                ? 'bg-blue-600 text-white'
                                                : 'text-blue-100 hover:bg-white hover:bg-opacity-10'
                                        }`}
                                    >
                                        <div className="text-xl mb-1">{tab.icon}</div>
                                        <div className="text-xs">{tab.label}</div>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Tab Content */}
                        <div className="min-h-96">
                            {activeTab === 'students' && <StudentManagement />}
                            {activeTab === 'classes' && <ClassManagement />}
                            {activeTab === 'schedule' && <ScheduleManagement />}
                            {activeTab === 'attendance' && <AttendanceManagement />}
                            {activeTab === 'analytics' && <BusinessAnalytics />}
                            {activeTab === 'risk-analysis' && <RiskAnalysis />}
                            {activeTab === 'communications' && <Communications />}
                            {activeTab === 'system' && <SystemStatus />}
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [user, setUser] = useState(null);
            const [mode, setMode] = useState('login');

            useEffect(() => {
                const token = localStorage.getItem('auth_token');
                const accessCode = localStorage.getItem('access_code');
               
                if (token === 'professional_session' && accessCode === 'ADELYNN14') {
                    setUser({
                        name: 'Admin User',
                        role: 'owner',
                        gym_name: 'BJJ Pro Academy',
                        plan: 'Professional',
                        hasProAccess: true,
                        accessCode: accessCode
                    });
                    setMode('dashboard');
                } else {
                    localStorage.removeItem('auth_token');
                    localStorage.removeItem('access_code');
                    setMode('login');
                }
            }, []);

            const handleLogin = (adminInfo) => {
                setUser(adminInfo);
                setMode('dashboard');
            };

            const handleLogout = () => {
                localStorage.removeItem('auth_token');
                localStorage.removeItem('access_code');
                setUser(null);
                setMode('login');
            };

            const handleCheckInMode = () => {
                setMode('checkin');
            };

            const handleBackToDashboard = () => {
                setMode('dashboard');
            };

            if (mode === 'login') {
                return <Login onLogin={handleLogin} />;
            }

            if (mode === 'checkin') {
                return <CheckInInterface onBack={handleBackToDashboard} />;
            }

            if (mode === 'dashboard' && user?.hasProAccess) {
                return (
                    <Dashboard
                        adminInfo={user}
                        onLogout={handleLogout}
                        onCheckInMode={handleCheckInMode}
                    />
                );
            }

            return <Login onLogin={handleLogin} />;
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html> mb-2">
                                            Professional Access Code
                                        </label>
                                        <input
                                            type="text"
                                            value={accessCode}
                                            onChange={(e) => setAccessCode(e.target.value.toUpperCase())}
                                            placeholder="Enter your access code"
                                            required
                                            autoFocus
                                            style={{ textTransform: 'uppercase', letterSpacing: '2px', textAlign: 'center' }}
                                        />
                                    </div>

                                    {error && (
                                        <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg text-center">
                                            {error}
                                        </div>
                                    )}

                                    <button
                                        type="submit"
                                        disabled={isLoading}
                                        className="glass-button w-full text-white font-semibold"
                                    >
                                        {isLoading ? 'Verifying...' : 'üîì Verify Access Code'}
                                    </button>
                                </form>

                                <div className="mt-6 text-center text-blue-300 text-xs">
                                    <p>BJJ Pro Gym Professional Edition</p>
                                    <p>Access Code: ADELYNN14</p>
                                    <div className="mt-4 space-y-2">
                                        <button 
                                            onClick={() => setShowPricing(true)}
                                            className="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg"
                                        >
                                            üí≥ View Pricing Plans
                                        </button>
                                        <button 
                                            onClick={() => window.open('mailto:sales@bjjprogym.com?subject=Demo Request&body=I would like to schedule a demo of BJJ Pro Gym.', '_blank')}
                                            className="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg text-sm"
                                        >
                                            üìß Request Demo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div>
                                <div className="text-center mb-6">
                                    <div className="text-green-400 mb-2">‚úÖ Access Code Verified</div>
                                    <h2 className="text-xl font-semibold text-white mb-2">Admin Login</h2>
                                    <p className="text-blue-200 text-sm">Professional access granted with code: {accessCode}</p>
                                </div>

                                <form onSubmit={handleAdminLogin} className="space-y-6">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">
                                            Admin Username
                                        </label>
                                        <input
                                            type="text"
                                            value={adminCredentials.username}
                                            onChange={(e) => setAdminCredentials({...adminCredentials, username: e.target.value})}
                                            placeholder="Enter admin username"
                                            required
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">
                                            Password
                                        </label>
                                        <input
                                            type="password"
                                            value={adminCredentials.password}
                                            onChange={(e) => setAdminCredentials({...adminCredentials, password: e.target.value})}
                                            placeholder="Enter password"
                                            required
                                        />
                                    </div>

                                    {error && (
                                        <div className="bg-red-500 bg-opacity-20 border border-red-300 text-red-100 px-4 py-3 rounded-lg">
                                            {error}
                                        </div>
                                    )}

                                    <button
                                        type="submit"
                                        disabled={isLoading}
                                        className="glass-button w-full text-white font-semibold"
                                    >
                                        {isLoading ? 'Logging in...' : 'üöÄ Enter Dashboard'}
                                    </button>
                                </form>

                                <div className="mt-4 text-center">
                                    <button
                                        onClick={resetAccess}
                                        className="text-blue-300 hover:text-white text-sm underline"
                                    >
                                        ‚Üê Use Different Access Code
                                    </button>
                                </div>

                                <div className="mt-6 text-center text-blue-200 text-sm">
                                    <p><strong>Demo Login:</strong></p>
                                    <p>Username: ADMIN001</p>
                                    <p>Password: admin123</p>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Student Management Component
        const StudentManagement = () => {
            const [students, setStudents] = useState([
                { id: 1, name: 'John Smith', email: 'john@email.com', phone: '555-0101', belt_level: 'Blue', member_id: 'MBR001', card_number: 'CARD1001' },
                { id: 2, name: 'Maria Garcia', email: 'maria@email.com', phone: '555-0102', belt_level: 'White', member_id: 'MBR002', card_number: 'CARD1002' },
                { id: 3, name: 'David Johnson', email: 'david@email.com', phone: '555-0103', belt_level: 'Purple', member_id: 'MBR003', card_number: 'CARD1003' },
                { id: 4, name: 'Sarah Wilson', email: 'sarah@email.com', phone: '555-0104', belt_level: 'White', member_id: 'MBR004', card_number: 'CARD1004' },
                { id: 5, name: 'Mike Brown', email: 'mike@email.com', phone: '555-0105', belt_level: 'Blue', member_id: 'MBR005', card_number: 'CARD1005' },
                { id: 6, name: 'Lisa Davis', email: 'lisa@email.com', phone: '555-0106', belt_level: 'Purple', member_id: 'MBR006', card_number: 'CARD1006' },
                { id: 7, name: 'Tom Wilson', email: 'tom@email.com', phone: '555-0107', belt_level: 'Brown', member_id: 'MBR007', card_number: 'CARD1007' },
                { id: 8, name: 'Anna Lee', email: 'anna@email.com', phone: '555-0108', belt_level: 'White', member_id: 'MBR008', card_number: 'CARD1008' },
                { id: 9, name: 'Carlos Silva', email: 'carlos@email.com', phone: '555-0109', belt_level: 'Black', member_id: 'MBR009', card_number: 'CARD1009' },
                { id: 10, name: 'Jessica Taylor', email: 'jessica@email.com', phone: '555-0110', belt_level: 'Blue', member_id: 'MBR010', card_number: 'CARD1010' },
                { id: 11, name: 'Roberto Santos', email: 'roberto@email.com', phone: '555-0111', belt_level: 'Purple', member_id: 'MBR011', card_number: 'CARD1011' },
                { id: 12, name: 'Michelle Kim', email: 'michelle@email.com', phone: '555-0112', belt_level: 'White', member_id: 'MBR012', card_number: 'CARD1012' },
                { id: 13, name: 'Alex Rodriguez', email: 'alex@email.com', phone: '555-0113', belt_level: 'Brown', member_id: 'MBR013', card_number: 'CARD1013' },
                { id: 14, name: 'Emma Thompson', email: 'emma@email.com', phone: '555-0114', belt_level: 'Blue', member_id: 'MBR014', card_number: 'CARD1014' },
                { id: 15, name: 'Ryan O\'Connor', email: 'ryan@email.com', phone: '555-0115', belt_level: 'White', member_id: 'MBR015', card_number: 'CARD1015' }
            ]);
           
            const [filteredStudents, setFilteredStudents] = useState(students);
            const [showAddForm, setShowAddForm] = useState(false);
            const [success, setSuccess] = useState('');
           
            // Filter states
            const [nameFilter, setNameFilter] = useState('');
            const [emailFilter, setEmailFilter] = useState('');
            const [phoneFilter, setPhoneFilter] = useState('');
            const [beltFilter, setBeltFilter] = useState('');
            const [memberIdFilter, setMemberIdFilter] = useState('');
            const [cardNumberFilter, setCardNumberFilter] = useState('');

            // Form state
            const [newStudent, setNewStudent] = useState({
                name: '',
                email: '',
                phone: '',
                belt_level: 'White'
            });

            useEffect(() => {
                setFilteredStudents(students);
            }, [students]);

            useEffect(() => {
                let filtered = students.filter(student => {
                    const matchesName = !nameFilter || student.name.toLowerCase().includes(nameFilter.toLowerCase());
                    const matchesEmail = !emailFilter || (student.email && student.email.toLowerCase().includes(emailFilter.toLowerCase()));
                    const matchesPhone = !phoneFilter || (student.phone && student.phone.includes(phoneFilter));
                    const matchesBelt = !beltFilter || student.belt_level === beltFilter;
                    const matchesMemberId = !memberIdFilter || (student.member_id && student.member_id.toLowerCase().includes(memberIdFilter.toLowerCase()));
                    const matchesCardNumber = !cardNumberFilter || (student.card_number && student.card_number.toLowerCase().includes(cardNumberFilter.toLowerCase()));

                    return matchesName && matchesEmail && matchesPhone && matchesBelt && matchesMemberId && matchesCardNumber;
                });
                setFilteredStudents(filtered);
            }, [students, nameFilter, emailFilter, phoneFilter, beltFilter, memberIdFilter, cardNumberFilter]);

            const handleAddStudent = (e) => {
                e.preventDefault();
                if (!newStudent.name.trim()) return;
               
                const newId = Math.max(...students.map(s => s.id)) + 1;
                const memberCount = students.length + 1;
                const newStudentData = {
                    id: newId,
                    name: newStudent.name.trim(),
                    email: newStudent.email.trim(),
                    phone: newStudent.phone.trim(),
                    belt_level: newStudent.belt_level,
                    member_id: `MBR${memberCount.toString().padStart(3, '0')}`,
                    card_number: `CARD${(1000 + memberCount).toString()}`
                };
               
                setStudents(prev => [...prev, newStudentData]);
                setNewStudent({ name: '', email: '', phone: '', belt_level: 'White' });
                setShowAddForm(false);
                setSuccess('‚úÖ Student added successfully!');
                setTimeout(() => setSuccess(''), 3000);
            };

            const clearAllFilters = () => {
                setNameFilter('');
                setEmailFilter('');
                setPhoneFilter('');
                setBeltFilter('');
                setMemberIdFilter('');
                setCardNumberFilter('');
            };

            const belts = ['White', 'Blue', 'Purple', 'Brown', 'Black'];

            return (
                <div className="space-y-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <h2 className="text-2xl font-bold text-white">Student Management</h2>
                        <button
                            onClick={() => setShowAddForm(true)}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ‚ûï Add Student
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    {/* Advanced Filtering */}
                    <div className="glass-effect rounded-xl p-6">
                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4">
                            <h3 className="text-lg font-semibold text-white">üîç Advanced Filters</h3>
                            <button
                                onClick={clearAllFilters}
                                className="text-blue-300 hover:text-white text-sm underline"
                            >
                                Clear All Filters
                            </button>
                        </div>
                       
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Name</label>
                                <input
                                    type="text"
                                    value={nameFilter}
                                    onChange={(e) => setNameFilter(e.target.value)}
                                    placeholder="Filter by name..."
                                />
                            </div>
                           
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Email</label>
                                <input
                                    type="text"
                                    value={emailFilter}
                                    onChange={(e) => setEmailFilter(e.target.value)}
                                    placeholder="Filter by email..."
                                />
                            </div>
                           
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Phone</label>
                                <input
                                    type="text"
                                    value={phoneFilter}
                                    onChange={(e) => setPhoneFilter(e.target.value)}
                                    placeholder="Filter by phone..."
                                />
                            </div>
                           
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Belt Level</label>
                                <select
                                    value={beltFilter}
                                    onChange={(e) => setBeltFilter(e.target.value)}
                                >
                                    <option value="">All Belts</option>
                                    {belts.map(belt => (
                                        <option key={belt} value={belt}>{belt} Belt</option>
                                    ))}
                                </select>
                            </div>
                           
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Member ID</label>
                                <input
                                    type="text"
                                    value={memberIdFilter}
                                    onChange={(e) => setMemberIdFilter(e.target.value)}
                                    placeholder="Filter by Member ID..."
                                />
                            </div>
                           
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Card Number</label>
                                <input
                                    type="text"
                                    value={cardNumberFilter}
                                    onChange={(e) => setCardNumberFilter(e.target.value)}
                                    placeholder="Filter by Card Number..."
                                />
                            </div>
                        </div>

                        <div className="mt-4 text-blue-200 text-sm">
                            Showing {filteredStudents.length} of {students.length} students
                        </div>
                    </div>

                    {/* Students List */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">Students ({filteredStudents.length})</h3>
                       
                        <div className="space-y-3">
                            {filteredStudents.map((student) => (
                                <div key={student.id} className="bg-white bg-opacity-10 rounded-lg p-4 hover:bg-opacity-20 transition-colors">
                                    <div className="flex flex-col lg:flex-row justify-between items-start gap-4">
                                        <div className="flex-1">
                                            <div className="flex flex-col sm:flex-row items-start sm:items-center gap-3 mb-2">
                                                <h4 className="font-semibold text-white text-lg">{student.name}</h4>
                                                <span className={`belt-${student.belt_level.toLowerCase()} px-3 py-1 rounded-full text-sm font-medium`}>
                                                    {student.belt_level} Belt
                                                </span>
                                            </div>
                                           
                                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-2 text-blue-100 text-sm mb-2">
                                                <div>üìß {student.email}</div>
                                                <div>üì± {student.phone}</div>
                                            </div>
                                           
                                            <div className="flex flex-wrap gap-2">
                                                <span className="member-id-badge">{student.member_id}</span>
                                                <span className="card-number-badge">{student.card_number}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Add Student Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-bold text-white mb-4">Add New Student</h3>
                               
                                <form onSubmit={handleAddStudent} className="space-y-4">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Name *</label>
                                        <input
                                            type="text"
                                            value={newStudent.name}
                                            onChange={(e) => setNewStudent({...newStudent, name: e.target.value})}
                                            required
                                        />
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Email</label>
                                        <input
                                            type="email"
                                            value={newStudent.email}
                                            onChange={(e) => setNewStudent({...newStudent, email: e.target.value})}
                                        />
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Phone</label>
                                        <input
                                            type="tel"
                                            value={newStudent.phone}
                                            onChange={(e) => setNewStudent({...newStudent, phone: e.target.value})}
                                        />
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Belt Level</label>
                                        <select
                                            value={newStudent.belt_level}
                                            onChange={(e) => setNewStudent({...newStudent, belt_level: e.target.value})}
                                        >
                                            {belts.map(belt => (
                                                <option key={belt} value={belt}>{belt} Belt</option>
                                            ))}
                                        </select>
                                    </div>
                                   
                                    <div className="flex gap-3">
                                        <button
                                            type="submit"
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            Add Student
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setShowAddForm(false)}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Class Management Component
        const ClassManagement = () => {
            const [classes, setClasses] = useState([
                { id: 1, name: 'Fundamentals', description: 'Basic BJJ techniques for beginners', created_at: new Date().toISOString() },
                { id: 2, name: 'Advanced', description: 'Advanced techniques and sparring', created_at: new Date().toISOString() },
                { id: 3, name: 'Competition', description: 'Competition preparation and training', created_at: new Date().toISOString() },
                { id: 4, name: 'No-Gi', description: 'Brazilian Jiu-Jitsu without gi', created_at: new Date().toISOString() },
                { id: 5, name: 'Open Mat', description: 'Free training and practice time', created_at: new Date().toISOString() },
                { id: 6, name: 'Kids Program', description: 'BJJ classes designed for children', created_at: new Date().toISOString() }
            ]);
           
            const [success, setSuccess] = useState('');
            const [showAddForm, setShowAddForm] = useState(false);
            const [newClass, setNewClass] = useState({ name: '', description: '' });

            const handleAddClass = (e) => {
                e.preventDefault();
                if (!newClass.name.trim()) return;
               
                const newId = Math.max(...classes.map(c => c.id)) + 1;
                const newClassItem = {
                    id: newId,
                    name: newClass.name.trim(),
                    description: newClass.description.trim(),
                    created_at: new Date().toISOString()
                };
               
                setClasses(prev => [...prev, newClassItem]);
                setNewClass({ name: '', description: '' });
                setShowAddForm(false);
                setSuccess('‚úÖ Class added successfully!');
                setTimeout(() => setSuccess(''), 3000);
            };

            const handleDeleteClass = (classId, className) => {
                if (!window.confirm(`Are you sure you want to delete "${className}"? This action cannot be undone.`)) return;
               
                setClasses(prev => prev.filter(c => c.id !== classId));
                setSuccess(`‚úÖ Class "${className}" deleted successfully!`);
                setTimeout(() => setSuccess(''), 3000);
            };

            return (
                <div className="space-y-6">
                    <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                        <div>
                            <h2 className="text-3xl font-bold text-white mb-2">üìö Class Management</h2>
                            <p className="text-blue-100">Manage your BJJ classes and training programs</p>
                        </div>
                        <button
                            onClick={() => setShowAddForm(true)}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ‚ûï Add New Class
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    <div className="glass-effect rounded-xl p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-xl font-semibold text-white">Classes ({classes.length})</h3>
                        </div>
                       
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {classes.map((classItem) => (
                                <div key={classItem.id} className="bg-white bg-opacity-10 rounded-lg p-6 hover:bg-opacity-20 transition-all duration-300 border border-white border-opacity-20">
                                    <div className="flex justify-between items-start mb-4">
                                        <div className="flex-1">
                                            <h4 className="font-bold text-white text-xl mb-2">{classItem.name}</h4>
                                            <div className="flex items-center gap-2 mb-3">
                                                <span className="bg-blue-500 bg-opacity-30 px-3 py-1 rounded-full text-blue-100 text-sm font-medium">
                                                    ü•ã BJJ Class
                                                </span>
                                            </div>
                                        </div>
                                        <button
                                            onClick={() => handleDeleteClass(classItem.id, classItem.name)}
                                            className="bg-red-500 bg-opacity-20 p-3 text-red-100 rounded-lg hover:bg-opacity-40 transition-all"
                                            title="Delete class"
                                        >
                                            üóëÔ∏è
                                        </button>
                                    </div>
                                   
                                    {classItem.description && (
                                        <div className="text-blue-100 text-sm mb-4">
                                            üìù {classItem.description}
                                        </div>
                                    )}
                                   
                                    <div className="flex justify-between items-center text-xs text-blue-300">
                                        <span>Created: {new Date(classItem.created_at).toLocaleDateString()}</span>
                                        <span className="bg-green-500 bg-opacity-20 px-2 py-1 rounded text-green-100">
                                            Active
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Add Class Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-white">Add New Class</h3>
                                    <button
                                        onClick={() => setShowAddForm(false)}
                                        className="text-blue-200 hover:text-white text-2xl"
                                    >
                                        ‚úï
                                    </button>
                                </div>
                               
                                <form onSubmit={handleAddClass} className="space-y-6">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-semibold mb-3">
                                            Class Name *
                                        </label>
                                        <input
                                            type="text"
                                            value={newClass.name}
                                            onChange={(e) => setNewClass({...newClass, name: e.target.value})}
                                            placeholder="e.g., Fundamentals, Advanced, No-Gi, Kids Program"
                                            required
                                            autoFocus
                                        />
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-semibold mb-3">
                                            Description (Optional)
                                        </label>
                                        <textarea
                                            value={newClass.description}
                                            onChange={(e) => setNewClass({...newClass, description: e.target.value})}
                                            placeholder="Describe what this class focuses on, skill level, techniques covered..."
                                            rows="4"
                                            className="w-full resize-none"
                                        />
                                    </div>
                                   
                                    <div className="flex gap-3 pt-4">
                                        <button
                                            type="submit"
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            ‚úÖ Add Class
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setShowAddForm(false)}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Schedule Management Component
        const ScheduleManagement = () => {
            const [schedules, setSchedules] = useState([
                { id: 1, class_name: 'Fundamentals', day_of_week: 0, start_time: '18:00', end_time: '19:00', instructor: 'Professor Silva' },
                { id: 2, class_name: 'Advanced', day_of_week: 0, start_time: '19:15', end_time: '20:45', instructor: 'Professor Johnson' },
                { id: 3, class_name: 'No-Gi', day_of_week: 1, start_time: '19:00', end_time: '20:00', instructor: 'Professor Davis' },
                { id: 4, class_name: 'Fundamentals', day_of_week: 2, start_time: '18:00', end_time: '19:00', instructor: 'Professor Silva' },
                { id: 5, class_name: 'Competition', day_of_week: 2, start_time: '19:15', end_time: '21:15', instructor: 'Professor Brown' },
                { id: 6, class_name: 'Open Mat', day_of_week: 4, start_time: '18:00', end_time: '20:00', instructor: 'Open' },
                { id: 7, class_name: 'Fundamentals', day_of_week: 5, start_time: '10:00', end_time: '11:00', instructor: 'Professor Silva' },
                { id: 8, class_name: 'Open Mat', day_of_week: 5, start_time: '11:15', end_time: '13:15', instructor: 'Open' }
            ]);
           
            const [success, setSuccess] = useState('');
            const [showAddForm, setShowAddForm] = useState(false);
            const [newSchedule, setNewSchedule] = useState({
                class_name: '',
                day_of_week: 0,
                start_time: '18:00',
                end_time: '19:00',
                instructor: ''
            });

            const classes = ['Fundamentals', 'Advanced', 'Competition', 'No-Gi', 'Open Mat', 'Kids Program'];
            const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            const handleAddSchedule = (e) => {
                e.preventDefault();
                if (!newSchedule.class_name.trim()) return;
               
                const newId = Math.max(...schedules.map(s => s.id)) + 1;
                const newScheduleItem = {
                    id: newId,
                    ...newSchedule
                };
               
                setSchedules(prev => [...prev, newScheduleItem]);
                setNewSchedule({
                    class_name: '',
                    day_of_week: 0,
                    start_time: '18:00',
                    end_time: '19:00',
                    instructor: ''
                });
                setShowAddForm(false);
                setSuccess('‚úÖ Schedule added successfully!');
                setTimeout(() => setSuccess(''), 3000);
            };

            const handleDeleteSchedule = (scheduleId) => {
                if (!confirm('Are you sure you want to delete this schedule?')) return;
               
                setSchedules(prev => prev.filter(s => s.id !== scheduleId));
                setSuccess('‚úÖ Schedule deleted successfully!');
                setTimeout(() => setSuccess(''), 3000);
            };

            const formatTime = (time) => {
                const [hours, minutes] = time.split(':');
                const hour = parseInt(hours);
                const ampm = hour >= 12 ? 'PM' : 'AM';
                const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
                return `${displayHour}:${minutes} ${ampm}`;
            };

            return (
                <div className="space-y-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <h2 className="text-2xl font-bold text-white">Schedule Management</h2>
                        <button
                            onClick={() => setShowAddForm(true)}
                            className="glass-button px-6 py-3 text-white font-semibold"
                        >
                            ‚ûï Add Schedule
                        </button>
                    </div>

                    {success && (
                        <div className="bg-green-500 bg-opacity-20 border border-green-300 text-green-100 px-4 py-3 rounded-lg success-pulse">
                            {success}
                        </div>
                    )}

                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-6">Weekly Schedule</h3>
                       
                        <div className="space-y-4">
                            {daysOfWeek.map((day, dayIndex) => {
                                const daySchedules = schedules
                                    .filter(s => s.day_of_week === dayIndex)
                                    .sort((a, b) => a.start_time.localeCompare(b.start_time));
                               
                                return (
                                    <div key={day} className="bg-white bg-opacity-5 rounded-lg p-4">
                                        <h4 className="font-semibold text-white text-lg mb-3">
                                            {day}
                                        </h4>
                                       
                                        {daySchedules.length === 0 ? (
                                            <div className="text-blue-300 text-sm">No classes scheduled</div>
                                        ) : (
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                                {daySchedules.map((schedule) => (
                                                    <div key={schedule.id} className="bg-white bg-opacity-10 rounded-lg p-3 relative group">
                                                        <button
                                                            onClick={() => handleDeleteSchedule(schedule.id)}
                                                            className="absolute top-2 right-2 text-red-400 hover:text-red-300 opacity-0 group-hover:opacity-100 transition-opacity"
                                                            title="Delete schedule"
                                                        >
                                                            ‚ùå
                                                        </button>
                                                        <div className="font-medium text-white pr-6">{schedule.class_name}</div>
                                                        <div className="text-blue-200 text-sm">
                                                            {formatTime(schedule.start_time)} - {formatTime(schedule.end_time)}
                                                        </div>
                                                        {schedule.instructor && (
                                                            <div className="text-blue-300 text-sm">
                                                                üë®‚Äçüè´ {schedule.instructor}
                                                            </div>
                                                        )}
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Add Schedule Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
                                <h3 className="text-xl font-bold text-white mb-4">Add New Schedule</h3>
                               
                                <form onSubmit={handleAddSchedule} className="space-y-4">
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Class *</label>
                                        <select
                                            value={newSchedule.class_name}
                                            onChange={(e) => setNewSchedule({...newSchedule, class_name: e.target.value})}
                                            required
                                        >
                                            <option value="">Select a class</option>
                                            {classes.map(cls => (
                                                <option key={cls} value={cls}>{cls}</option>
                                            ))}
                                        </select>
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Day of Week *</label>
                                        <select
                                            value={newSchedule.day_of_week}
                                            onChange={(e) => setNewSchedule({...newSchedule, day_of_week: parseInt(e.target.value)})}
                                            required
                                        >
                                            {daysOfWeek.map((day, index) => (
                                                <option key={index} value={index}>{day}</option>
                                            ))}
                                        </select>
                                    </div>
                                   
                                    <div className="grid grid-cols-2 gap-3">
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">Start Time *</label>
                                            <input
                                                type="time"
                                                value={newSchedule.start_time}
                                                onChange={(e) => setNewSchedule({...newSchedule, start_time: e.target.value})}
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-blue-100 text-sm font-medium mb-2">End Time *</label>
                                            <input
                                                type="time"
                                                value={newSchedule.end_time}
                                                onChange={(e) => setNewSchedule({...newSchedule, end_time: e.target.value})}
                                                required
                                            />
                                        </div>
                                    </div>
                                   
                                    <div>
                                        <label className="block text-blue-100 text-sm font-medium mb-2">Instructor</label>
                                        <input
                                            type="text"
                                            value={newSchedule.instructor}
                                            onChange={(e) => setNewSchedule({...newSchedule, instructor: e.target.value})}
                                            placeholder="Instructor name"
                                        />
                                    </div>
                                   
                                    <div className="flex gap-3">
                                        <button
                                            type="submit"
                                            className="glass-button flex-1 text-white font-semibold"
                                        >
                                            Add Schedule
                                        </button>
                                        <button
                                            type="button"
                                            onClick={() => setShowAddForm(false)}
                                            className="bg-gray-500 bg-opacity-20 flex-1 text-white font-semibold hover:bg-opacity-30"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Attendance Management Component
        const AttendanceManagement = () => {
            const [attendanceData, setAttendanceData] = useState([
                { id: 1, student_name: 'John Smith', class_name: 'Fundamentals', check_in_time: '2025-01-05 18:05', member_id: 'MBR001', card_number: 'CARD1001' },
                { id: 2, student_name: 'Maria Garcia', class_name: 'Fundamentals', check_in_time: '2025-01-05 18:08', member_id: 'MBR002', card_number: 'CARD1002' },
                { id: 3, student_name: 'David Johnson', class_name: 'Advanced', check_in_time: '2025-01-05 19:20', member_id: 'MBR003', card_number: 'CARD1003' },
                { id: 4, student_name: 'Sarah Wilson', class_name: 'No-Gi', check_in_time: '2025-01-04 19:05', member_id: 'MBR004', card_number: 'CARD1004' },
                { id: 5, student_name: 'Mike Brown', class_name: 'Fundamentals', check_in_time: '2025-01-04 18:12', member_id: 'MBR005', card_number: 'CARD1005' },
                { id: 6, student_name: 'Lisa Davis', class_name: 'Competition', check_in_time: '2025-01-03 19:18', member_id: 'MBR006', card_number: 'CARD1006' },
                { id: 7, student_name: 'Tom Wilson', class_name: 'Open Mat', check_in_time: '2025-01-03 18:30', member_id: 'MBR007', card_number: 'CARD1007' }
            ]);
           
            const [filterDate, setFilterDate] = useState('');
            const [filterStudent, setFilterStudent] = useState('');
            const [filterClass, setFilterClass] = useState('');
           
            const filteredData = attendanceData.filter(record => {
                const matchesDate = !filterDate || record.check_in_time.includes(filterDate);
                const matchesStudent = !filterStudent || record.student_name.toLowerCase().includes(filterStudent.toLowerCase());
                const matchesClass = !filterClass || record.class_name.toLowerCase().includes(filterClass.toLowerCase());
                return matchesDate && matchesStudent && matchesClass;
            });

            const todayCount = attendanceData.filter(record =>
                record.check_in_time.includes(new Date().toISOString().split('T')[0])
            ).length;

            const weekCount = attendanceData.length;

            return (
                <div className="space-y-6">
                    <div>
                        <h2 className="text-3xl font-bold text-white mb-2">‚úÖ Attendance Tracking</h2>
                        <p className="text-blue-100">Real-time student check-ins and attendance analytics</p>
                    </div>

                    {/* Stats Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-white">{todayCount}</div>
                            <div className="text-blue-200 text-sm">Today's Check-ins</div>
                        </div>
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-white">{weekCount}</div>
                            <div className="text-blue-200 text-sm">This Week</div>
                        </div>
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-white">87%</div>
                            <div className="text-blue-200 text-sm">Attendance Rate</div>
                        </div>
                    </div>

                    {/* Filters */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üîç Filter Attendance</h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Date</label>
                                <input
                                    type="date"
                                    value={filterDate}
                                    onChange={(e) => setFilterDate(e.target.value)}
                                />
                            </div>
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Student</label>
                                <input
                                    type="text"
                                    value={filterStudent}
                                    onChange={(e) => setFilterStudent(e.target.value)}
                                    placeholder="Filter by student name..."
                                />
                            </div>
                            <div>
                                <label className="block text-blue-100 text-sm font-medium mb-2">Class</label>
                                <input
                                    type="text"
                                    value={filterClass}
                                    onChange={(e) => setFilterClass(e.target.value)}
                                    placeholder="Filter by class..."
                                />
                            </div>
                        </div>
                        <div className="mt-4 text-blue-200 text-sm">
                            Showing {filteredData.length} attendance records
                        </div>
                    </div>

                    {/* Attendance List */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">Recent Check-ins</h3>
                        <div className="space-y-3">
                            {filteredData.map((record) => (
                                <div key={record.id} className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <div className="font-semibold text-white">{record.student_name}</div>
                                            <div className="text-blue-200 text-sm">{record.class_name}</div>
                                            <div className="text-blue-300 text-sm flex gap-2">
                                                <span className="member-id-badge">{record.member_id}</span>
                                                <span className="card-number-badge">{record.card_number}</span>
                                            </div>
                                        </div>
                                        <div className="text-right">
                                            <div className="text-white text-sm">
                                                {new Date(record.check_in_time).toLocaleString()}
                                            </div>
                                            <div className="bg-green-500 bg-opacity-20 px-2 py-1 rounded text-green-100 text-xs mt-1">
                                                ‚úÖ Checked In
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Business Analytics Component
        const BusinessAnalytics = () => {
            const [selectedPeriod, setSelectedPeriod] = useState('month');
           
            const metrics = {
                revenue: { current: 29550, previous: 27800, growth: 6.3 },
                students: { current: 157, previous: 148, growth: 6.1 },
                retention: { current: 87, previous: 82, growth: 6.1 },
                classes: { current: 124, previous: 118, growth: 5.1 }
            };

            const beltDistribution = [
                { belt: 'White', count: 68, percentage: 43 },
                { belt: 'Blue', count: 45, percentage: 29 },
                { belt: 'Purple', count: 28, percentage: 18 },
                { belt: 'Brown', count: 12, percentage: 8 },
                { belt: 'Black', count: 4, percentage: 2 }
            ];

            const popularClasses = [
                { name: 'Fundamentals', attendance: 92, capacity: 100 },
                { name: 'Advanced', attendance: 78, capacity: 85 },
                { name: 'No-Gi', attendance: 65, capacity: 75 },
                { name: 'Competition', attendance: 45, capacity: 60 },
                { name: 'Open Mat', attendance: 55, capacity: 80 }
            ];

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <div>
                            <h2 className="text-3xl font-bold text-white mb-2">üìä Business Analytics</h2>
                            <p className="text-blue-100">Comprehensive business metrics and performance insights</p>
                        </div>
                        <select
                            value={selectedPeriod}
                            onChange={(e) => setSelectedPeriod(e.target.value)}
                            className="bg-white bg-opacity-10 text-white border border-white border-opacity-20 rounded-lg px-4 py-2"
                        >
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                            <option value="year">This Year</option>
                        </select>
                    </div>

                    {/* Key Metrics */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div className="glass-effect rounded-xl p-6">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Revenue</div>
                                <div className="text-2xl">üí∞</div>
                            </div>
                            <div className="text-3xl font-bold text-white">${metrics.revenue.current.toLocaleString()}</div>
                            <div className="text-green-300 text-sm">+{metrics.revenue.growth}% vs last period</div>
                        </div>
                       
                        <div className="glass-effect rounded-xl p-6">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Students</div>
                                <div className="text-2xl">üë•</div>
                            </div>
                            <div className="text-3xl font-bold text-white">{metrics.students.current}</div>
                            <div className="text-green-300 text-sm">+{metrics.students.growth}% growth</div>
                        </div>
                       
                        <div className="glass-effect rounded-xl p-6">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Retention</div>
                                <div className="text-2xl">üéØ</div>
                            </div>
                            <div className="text-3xl font-bold text-white">{metrics.retention.current}%</div>
                            <div className="text-green-300 text-sm">+{metrics.retention.growth}% improvement</div>
                        </div>
                       
                        <div className="glass-effect rounded-xl p-6">
                            <div className="flex items-center justify-between mb-2">
                                <div className="text-lg font-semibold text-white">Classes</div>
                                <div className="text-2xl">üìö</div>
                            </div>
                            <div className="text-3xl font-bold text-white">{metrics.classes.current}</div>
                            <div className="text-green-300 text-sm">+{metrics.classes.growth}% this period</div>
                        </div>
                    </div>

                    {/* Belt Distribution */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">ü•ã Belt Level Distribution</h3>
                        <div className="space-y-3">
                            {beltDistribution.map((item, index) => (
                                <div key={index} className="flex items-center justify-between">
                                    <div className="flex items-center space-x-3">
                                        <span className={`belt-${item.belt.toLowerCase()} px-3 py-1 rounded-full text-sm font-medium`}>
                                            {item.belt} Belt
                                        </span>
                                        <span className="text-white">{item.count} students</span>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <div className="w-32 bg-white bg-opacity-20 rounded-full h-2">
                                            <div
                                                className="bg-blue-500 h-2 rounded-full"
                                                style={{ width: `${item.percentage}%` }}
                                            ></div>
                                        </div>
                                        <span className="text-blue-200 text-sm w-10">{item.percentage}%</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Popular Classes */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìà Class Popularity</h3>
                        <div className="space-y-3">
                            {popularClasses.map((classItem, index) => (
                                <div key={index} className="flex items-center justify-between">
                                    <div className="text-white font-medium">{classItem.name}</div>
                                    <div className="flex items-center space-x-2">
                                        <span className="text-blue-200 text-sm">
                                            {classItem.attendance}/{classItem.capacity}
                                        </span>
                                        <div className="w-24 bg-white bg-opacity-20 rounded-full h-2">
                                            <div
                                                className="bg-green-500 h-2 rounded-full"
                                                style={{ width: `${(classItem.attendance / classItem.capacity) * 100}%` }}
                                            ></div>
                                        </div>
                                        <span className="text-green-300 text-sm w-10">
                                            {Math.round((classItem.attendance / classItem.capacity) * 100)}%
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        // Risk Analysis Component - COMPLETE IMPLEMENTATION
        const RiskAnalysis = () => {
            const [atRiskStudents, setAtRiskStudents] = useState([
                { id: 1, name: 'Ryan O\'Connor', member_id: 'MBR015', last_attendance: '2024-12-15', days_absent: 21, risk_level: 'high', email: 'ryan@email.com', belt_level: 'White' },
                { id: 2, name: 'Emma Thompson', member_id: 'MBR014', last_attendance: '2024-12-28', days_absent: 8, risk_level: 'medium', email: 'emma@email.com', belt_level: 'Blue' },
                { id: 3, name: 'Michelle Kim', member_id: 'MBR012', last_attendance: '2024-12-20', days_absent: 16, risk_level: 'high', email: 'michelle@email.com', belt_level: 'White' },
                { id: 4, name: 'Alex Rodriguez', member_id: 'MBR013', last_attendance: '2025-01-02', days_absent: 3, risk_level: 'low', email: 'alex@email.com', belt_level: 'Brown' },
                { id: 5, name: 'Anna Lee', member_id: 'MBR008', last_attendance: '2024-12-25', days_absent: 11, risk_level: 'medium', email: 'anna@email.com', belt_level: 'White' }
            ]);

            const [selectedStudents, setSelectedStudents] = useState([]);
            const [showEmailModal, setShowEmailModal] = useState(false);
            const [emailTemplate, setEmailTemplate] = useState('');
            const [customSubject, setCustomSubject] = useState('');
            const [customMessage, setCustomMessage] = useState('');

            const emailTemplates = {
                'check-in': {
                    subject: 'We Miss You at BJJ Pro Academy!',
                    message: `Hi {name},

We noticed you haven't been to class in a while and wanted to check in with you. 

At BJJ Pro Academy, we care about each of our students and their martial arts journey. Whether you're dealing with schedule conflicts, injury concerns, or just need some motivation to get back on the mats, we're here to help.

Would you like to schedule a quick chat with one of our instructors? We're always happy to help you overcome any obstacles and get back to training.

See you soon on the mats!

Best regards,
BJJ Pro Academy Team`
                },
                'motivation': {
                    subject: 'Your BJJ Journey Continues - Let\'s Get You Back!',
                    message: `Hey {name},

Brazilian Jiu-Jitsu is a journey, not a destination - and every black belt was once a white belt who never gave up.

We understand that life can get busy and sometimes training takes a backseat. But remember why you started: the confidence, the fitness, the friendships, and the incredible feeling of learning something new every day.

Your spot on the mats is waiting for you. Come back when you're ready - we'll be here to support you every step of the way.

Osss!
Your BJJ Family`
                },
                'offer': {
                    subject: 'Special Welcome Back Offer - Just for You!',
                    message: `Hi {name},

We have something special for you! 

As a valued member of our BJJ family, we'd like to offer you a complimentary private lesson to help you get back into the rhythm of training. This one-on-one session will help you feel confident and prepared to return to group classes.

Additionally, we're offering a 50% discount on your next month's membership to help ease you back into your routine.

This offer is available for the next 30 days. Just reply to this email or give us a call to schedule your return.

We can't wait to see you back on the mats!

Best,
BJJ Pro Academy`
                }
            };

            const riskLevels = {
                high: { color: 'risk-high', icon: 'üî¥', days: '14+ days' },
                medium: { color: 'risk-medium', icon: 'üü°', days: '7-14 days' },
                low: { color: 'risk-low', icon: 'üü¢', days: '3-7 days' }
            };

            const handleStudentSelect = (studentId) => {
                setSelectedStudents(prev => 
                    prev.includes(studentId) 
                        ? prev.filter(id => id !== studentId)
                        : [...prev, studentId]
                );
            };

            const handleSendEmail = () => {
                const selectedStudentData = atRiskStudents.filter(s => selectedStudents.includes(s.id));
                
                if (selectedStudentData.length === 0) {
                    alert('Please select at least one student to send emails to.');
                    return;
                }

                const template = emailTemplates[emailTemplate];
                const subject = customSubject || template.subject;
                const message = customMessage || template.message;

                // Simulate sending emails
                alert(`‚úÖ Emails sent successfully to ${selectedStudentData.length} student(s)!\n\nSubject: ${subject}\n\nThis would send personalized emails to:\n${selectedStudentData.map(s => `‚Ä¢ ${s.name} (${s.email})`).join('\n')}`);
                
                setShowEmailModal(false);
                setSelectedStudents([]);
                setEmailTemplate('');
                setCustomSubject('');
                setCustomMessage('');
            };

            const getTemplatePreview = () => {
                if (!emailTemplate || !emailTemplates[emailTemplate]) return '';
                
                const template = emailTemplates[emailTemplate];
                const sampleStudent = selectedStudents.length > 0 
                    ? atRiskStudents.find(s => s.id === selectedStudents[0])
                    : { name: '[Student Name]' };
                
                return {
                    subject: template.subject,
                    message: template.message.replace('{name}', sampleStudent.name)
                };
            };

            const stats = {
                total: atRiskStudents.length,
                high: atRiskStudents.filter(s => s.risk_level === 'high').length,
                medium: atRiskStudents.filter(s => s.risk_level === 'medium').length,
                low: atRiskStudents.filter(s => s.risk_level === 'low').length
            };

            return (
                <div className="space-y-6">
                    <div>
                        <h2 className="text-3xl font-bold text-white mb-2">‚ö†Ô∏è Risk Analysis</h2>
                        <p className="text-blue-100">AI-powered student retention analysis and intervention tools</p>
                    </div>

                    {/* Risk Overview Stats */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-white">{stats.total}</div>
                            <div className="text-blue-200 text-sm">Total At-Risk</div>
                        </div>
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-red-300">{stats.high}</div>
                            <div className="text-blue-200 text-sm">High Risk</div>
                        </div>
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-yellow-300">{stats.medium}</div>
                            <div className="text-blue-200 text-sm">Medium Risk</div>
                        </div>
                        <div className="glass-effect rounded-xl p-4">
                            <div className="text-2xl font-bold text-green-300">{stats.low}</div>
                            <div className="text-blue-200 text-sm">Low Risk</div>
                        </div>
                    </div>

                    {/* Action Buttons */}
                    <div className="glass-effect rounded-xl p-4">
                        <div className="flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between">
                            <div className="text-white">
                                {selectedStudents.length > 0 ? (
                                    <span>{selectedStudents.length} student(s) selected</span>
                                ) : (
                                    <span>Select students to send retention emails</span>
                                )}
                            </div>
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setSelectedStudents(atRiskStudents.filter(s => s.risk_level === 'high').map(s => s.id))}
                                    className="bg-red-500 bg-opacity-20 px-4 py-2 text-red-100 rounded-lg hover:bg-opacity-30 text-sm"
                                >
                                    Select High Risk
                                </button>
                                <button
                                    onClick={() => setSelectedStudents(atRiskStudents.map(s => s.id))}
                                    className="bg-blue-500 bg-opacity-20 px-4 py-2 text-blue-100 rounded-lg hover:bg-opacity-30 text-sm"
                                >
                                    Select All
                                </button>
                                <button
                                    onClick={() => selectedStudents.length > 0 && setShowEmailModal(true)}
                                    disabled={selectedStudents.length === 0}
                                    className="glass-button px-4 py-2 text-white font-semibold text-sm disabled:opacity-50"
                                >
                                    üìß Send Retention Email
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* At-Risk Students List */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">At-Risk Students</h3>
                        
                        <div className="space-y-3">
                            {atRiskStudents.map((student) => {
                                const risk = riskLevels[student.risk_level];
                                return (
                                    <div key={student.id} className="bg-white bg-opacity-10 rounded-lg p-4">
                                        <div className="flex items-center justify-between">
                                            <div className="flex items-center space-x-4">
                                                <input
                                                    type="checkbox"
                                                    checked={selectedStudents.includes(student.id)}
                                                    onChange={() => handleStudentSelect(student.id)}
                                                    className="w-5 h-5 rounded"
                                                />
                                                <div>
                                                    <div className="flex items-center gap-3 mb-1">
                                                        <h4 className="font-semibold text-white">{student.name}</h4>
                                                        <span className={`belt-${student.belt_level.toLowerCase()} px-2 py-1 rounded-full text-xs font-medium`}>
                                                            {student.belt_level}
                                                        </span>
                                                        <span className={`${risk.color} px-2 py-1 rounded-full text-white text-xs font-medium`}>
                                                            {risk.icon} {student.risk_level.toUpperCase()} RISK
                                                        </span>
                                                    </div>
                                                    <div className="text-blue-200 text-sm">
                                                        {student.member_id} ‚Ä¢ {student.email}
                                                    </div>
                                                    <div className="text-blue-300 text-sm">
                                                        Last attended: {new Date(student.last_attendance).toLocaleDateString()} ‚Ä¢ {student.days_absent} days ago
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="text-right">
                                                <div className="text-blue-200 text-sm mb-1">Risk Factors:</div>
                                                <div className="text-xs text-blue-300">
                                                    ‚Ä¢ {student.days_absent} days absent<br/>
                                                    ‚Ä¢ {student.belt_level === 'White' ? 'New student' : 'Experienced'}<br/>
                                                    ‚Ä¢ Attendance declining
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Risk Analysis Insights */}
                    <div className="glass-effect rounded-xl p-6">
                        <h3 className="text-lg font-semibold text-white mb-4">üìä Retention Insights</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 className="font-medium text-white mb-3">Risk Level Definitions</h4>
                                <div className="space-y-2">
                                    <div className="flex items-center gap-3">
                                        <span className="risk-high px-2 py-1 rounded text-white text-xs">üî¥ HIGH</span>
                                        <span className="text-blue-200 text-sm">14+ days absent, immediate intervention needed</span>
                                    </div>
                                    <div className="flex items-center gap-3">
                                        <span className="risk-medium px-2 py-1 rounded text-white text-xs">üü° MEDIUM</span>
                                        <span className="text-blue-200 text-sm">7-14 days absent, check-in recommended</span>
                                    </div>
                                    <div className="flex items-center gap-3">
                                        <span className="risk-low px-2 py-1 rounded text-white text-xs">üü¢ LOW</span>
                                        <span className="text-blue-200 text-sm">3-7 days absent, gentle reminder</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 className="font-medium text-white mb-3">Recommended Actions</h4>
                                <ul className="text-blue-200 text-sm space-y-1">
                                    <li>‚Ä¢ Send personalized retention emails</li>
                                    <li>‚Ä¢ Offer private lessons for re-engagement</li>
                                    <li>‚Ä¢ Schedule instructor check-in calls</li>
                                    <li>‚Ä¢ Provide flexible class scheduling</li>
                                    <li>‚Ä¢ Address any concerns or barriers</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    {/* Email Modal */}
                    {showEmailModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="glass-effect rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-white">Send Retention Email</h3>
                                    <button
                                        onClick={() => setShowEmailModal(false)}
                                        className="text-blue-200 hover:text-white text-2xl"
                                    >
                                        ‚úï
                                    </button>
                                </div>

                                <div className="mb-6">
                                    <p className="text-blue-200 mb-2">
                                        Sending to {selectedStudents.length} student(s):
                                    </p>
                                    <div className="text-blue-100 text-sm">
                                        {atRiskStudents.filter(s => selectedStudents.includes(s.id)).map(s => s.name).join(', ')}
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div>
                                        <h4 className="font-semibold text-white mb-4">Choose Email Template</h4>
                                        <div className="space-y-3 mb-6">
                                            {Object.entries(emailTemplates).map(([key, template]) => (
                                                <div
                                                    key={key}
                                                    onClick={() => setEmailTemplate(key)}
                                                    className={`p-4 rounded-lg border cursor-pointer transition-all ${
                                                        emailTemplate === key 
                                                            ? 'border-blue-400 bg-blue-500 bg-opacity-20' 
                                                            : 'border-white border-opacity-20 bg-white bg-opacity-5 hover:bg-opacity-10'
                                                    }`}
                                                >
                                                    <div className="font-medium text-white mb-2">{template.subject}</div>
                                                    <div className="text-blue-200 text-sm">
                                                        {key === 'check-in' && 'Personal check-in to understand absence'}
                                                        {key === 'motivation' && 'Motivational message to inspire return'}
                                                        {key === 'offer' && 'Special offer to incentivize comeback'}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>

                                        {emailTemplate && (
                                            <div>
                                                <h4 className="font-semibold text-white mb-3">Customize Message (Optional)</h4>
                                                <div className="space-y-3">
                                                    <div>
                                                        <label className="block text-blue-100 text-sm font-medium mb-2">
                                                            Subject Line
                                                        </label>
                                                        <input
                                                            type="text"
                                                            value={customSubject}
                                                            onChange={(e) => setCustomSubject(e.target.value)}
                                                            placeholder={emailTemplates[emailTemplate]?.subject}
                                                        />
                                                    </div>
                                                    <div>
                                                        <label className="block text-blue-100 text-sm font-medium
